<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Analyse & Plan</title>
  <meta content="" name="description">
  <meta content="" name="keywords">

  <!-- Favicons -->
  <link href="assets/img/favicon.png" rel="icon">
  <link href="assets/img/apple-touch-icon.png" rel="apple-touch-icon">
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      word-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    /* div.sourceCode
      {   } */
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    /* code span.bu { } BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    /* code span.ex { } Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    /* code span.im { } Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}

    #logout {
    background-color: rgb(71, 15, 239); 
    border: none;
    color: white;
    font-size: larger;
    font-weight: bolder;
    position: absolute;
    right: 30px;
    top: 25px;
    padding: 5px 10px;
    text-align: center;
    text-decoration: none;
    display: inline-block;
    font-size: 16px;
    margin: 2px 2px;
    cursor: pointer;
}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<section id="data-analysis--automobile-dataset" class="cell markdown">
  <button id="logout" onclick="location.href='index.html';"> Log out </button>
<h1>DATA ANALYSIS : Automobile Dataset</h1>
<hr />
<p><img src = "https://coolmaterial.com/wp-content/uploads/2012/03/15-classic-cars-that-define-cool-hero-1000x600.jpg" width ="600" Height = "600" ></p>
<h2 id="problem"><code>Problem</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>Let's say we have a friend named Tom. And Tom wants to sell his car. But the problem is he doesn't know how much he should sell his car for. Tom wants to sell his car for as much as he can. But he also wants to set the price reasonably, so someone would want to purchase it. So the price he sets should represent the value of the car.How can we help Tom determine the best price for his car? Let's think like data scientists and clearly define some of his problems. For example, is there data on the prices of other cars and their characteristics? What features of cars affect their prices? Color? Brand? Does horsepower also effect the selling price, or perhaps something else? As a data analyst or data scientist, these are some of the questions we can start thinking about. To answer these questions, we're going to need some data.</b>
</div>
</section>
<div class="cell markdown">
<p><strong><code>The final model has efficiency of 84%</code> and below one is it's performance graph</strong></p>
</div>
<section id="table-of-content" class="cell markdown">
<h2><code>TABLE OF CONTENT</code></h2>
<hr />
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<ol>
    <li>Data Acquisition</li>
    <li>Identify and handle missing values</li>
    <li>Data Standardization</li>
    <li>Data Normalization</li>
    <li>Binning</li>
    <li>Analyzing Individual Feature Patterns using Visualization</li>
    <li>Model Development</li>
    <ul>
        <li>Linear Regression and Multiple Linear Regression</li>
        <li>Model Evaluation using Visualization</li>
        <li>Polynomial Regression and Pipeline</li>
        <li>Measures for Insample Evaluation</li>
        <li>Prediction and Decision Making</li>
    </ul>
     <li>Model Evaluation and Refinement</li>
    <li>Conclusion</li>
    <li>Reference</li>
</ol>
</div>
</section>
<section id="1data-acquisition" class="cell markdown">
<h2><code>1.Data Acquisition</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>There are various formats for a dataset, <code>.csv, .json, .xlsx</code>  etc. The dataset can be stored in different places, on your local machine or sometimes online.In our case, the <code>Automobile Dataset</code> is an online source, and it is in CSV (comma separated value) format. Let's use this dataset as an example to practice data reading.</b>
<ul>
<li>data source: <a href="https://archive.ics.uci.edu/ml/machine-learning-databases/autos/imports-85.data" target="_blank">https://archive.ics.uci.edu/ml/machine-learning-databases/autos/imports-85.data</a></li>
<li>date type  : .csv</li></ul> 
    
<br>The Pandas Library is a useful tool that enables us to read various datasets into a data frame;so that all we need to do is import Pandas. If you crossed by error, install it first.</br>

We use <code>pandas.read_csv()</code> function to read the csv file. In the bracket, we put the file path along with a quotation mark, so that pandas will read the file into a data frame from that address. The file path can be either an URL or your local file address.<br>
Because the data does not include headers, we can add an argument <code>headers = None</code>  inside the  <code>read_csv()</code> method, so that pandas will not automatically set the first row as a header.<br>
You can also assign the dataset to any variable you create.

</div>
</section>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>import helper libraries</b>
</div>
</div>
<div class="cell code" data-execution_count="174">
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> pyplot</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy <span class="im">import</span> stats</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interact, interactive, fixed, interact_manual</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>warnings. filterwarnings(<span class="st">&#39;ignore&#39;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>Read the online file by the URL provides above, and assign it to variable "df"</b>
</div>
</div>
<div class="cell code" data-execution_count="175">
<div class="sourceCode" id="cb2"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>url <span class="op">=</span> <span class="st">&quot;https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBMDeveloperSkillsNetwork-DA0101EN-SkillsNetwork/labs/Data</span><span class="sc">%20f</span><span class="st">iles/auto.csv&quot;</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(url, header<span class="op">=</span><span class="va">None</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>After reading the dataset, we can use the <code>dataframe.head(n)</code> method to check the top n rows of the dataframe; where n is an integer.</b>
</div>
</div>
<div class="cell code" data-execution_count="176">
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># show the first 5 rows using dataframe.head() method</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The first 5 rows of the dataframe&quot;</span>) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The first 5 rows of the dataframe
</code></pre>
</div>
<div class="output execute_result" data-execution_count="176">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>13495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>152</td>
      <td>mpfi</td>
      <td>2.68</td>
      <td>3.47</td>
      <td>9.0</td>
      <td>154</td>
      <td>5000</td>
      <td>19</td>
      <td>26</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>109</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>10.0</td>
      <td>102</td>
      <td>5500</td>
      <td>24</td>
      <td>30</td>
      <td>13950</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.0</td>
      <td>115</td>
      <td>5500</td>
      <td>18</td>
      <td>22</td>
      <td>17450</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>Contrary to <code>dataframe.head(n)</code>, <code>dataframe.tail(n)</code> will show you the bottom n rows of the dataframe.</b>
</div>
</div>
<div class="cell code" data-execution_count="177">
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The last 5 rows of the dataframe&quot;</span>) </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df.tail(<span class="dv">10</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The last 5 rows of the dataframe
</code></pre>
</div>
<div class="output execute_result" data-execution_count="177">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>8</th>
      <th>9</th>
      <th>...</th>
      <th>16</th>
      <th>17</th>
      <th>18</th>
      <th>19</th>
      <th>20</th>
      <th>21</th>
      <th>22</th>
      <th>23</th>
      <th>24</th>
      <th>25</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>195</th>
      <td>-1</td>
      <td>74</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>wagon</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.3</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>23</td>
      <td>28</td>
      <td>13415</td>
    </tr>
    <tr>
      <th>196</th>
      <td>-2</td>
      <td>103</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.3</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>24</td>
      <td>28</td>
      <td>15985</td>
    </tr>
    <tr>
      <th>197</th>
      <td>-1</td>
      <td>74</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>wagon</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.3</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>24</td>
      <td>28</td>
      <td>16515</td>
    </tr>
    <tr>
      <th>198</th>
      <td>-2</td>
      <td>103</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.3</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.62</td>
      <td>3.15</td>
      <td>7.5</td>
      <td>162</td>
      <td>5100</td>
      <td>17</td>
      <td>22</td>
      <td>18420</td>
    </tr>
    <tr>
      <th>199</th>
      <td>-1</td>
      <td>74</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>wagon</td>
      <td>rwd</td>
      <td>front</td>
      <td>104.3</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.62</td>
      <td>3.15</td>
      <td>7.5</td>
      <td>162</td>
      <td>5100</td>
      <td>17</td>
      <td>22</td>
      <td>18950</td>
    </tr>
    <tr>
      <th>200</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>23</td>
      <td>28</td>
      <td>16845</td>
    </tr>
    <tr>
      <th>201</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>8.7</td>
      <td>160</td>
      <td>5300</td>
      <td>19</td>
      <td>25</td>
      <td>19045</td>
    </tr>
    <tr>
      <th>202</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>173</td>
      <td>mpfi</td>
      <td>3.58</td>
      <td>2.87</td>
      <td>8.8</td>
      <td>134</td>
      <td>5500</td>
      <td>18</td>
      <td>23</td>
      <td>21485</td>
    </tr>
    <tr>
      <th>203</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>diesel</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>145</td>
      <td>idi</td>
      <td>3.01</td>
      <td>3.40</td>
      <td>23.0</td>
      <td>106</td>
      <td>4800</td>
      <td>26</td>
      <td>27</td>
      <td>22470</td>
    </tr>
    <tr>
      <th>204</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>19</td>
      <td>25</td>
      <td>22625</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 26 columns</p>
</div>
</div>
</div>
<section id="2identify-and-handle-missing-values" class="cell markdown">
<h2><code>2.IDENTIFY AND HANDLE MISSING VALUES</code></h2>
<h3 id="add-headers"><code>ADD HEADERS</code></h3>
<div class="alert alert-block alert-info" style="margin-top: 20px">
<p>
Take a look at our dataset; pandas automatically set the header by an integer from 0.
</p>
<p>
To better describe our data we can introduce a header, this information is available at:  <a href="https://archive.ics.uci.edu/ml/datasets/Automobile" target="_blank">https://archive.ics.uci.edu/ml/datasets/Automobile</a>
</p>
<p>
Thus, we have to add headers manually.
</p>
<p>
Firstly, we create a list "headers" that include all column names in order.
Then, we use <code>dataframe.columns = headers</code> to replace the headers by the list we created.
</p>
</div>
</section>
<div class="cell code" data-execution_count="178">
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create headers list</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>headers <span class="op">=</span> [<span class="st">&quot;symboling&quot;</span>,<span class="st">&quot;normalized-losses&quot;</span>,<span class="st">&quot;make&quot;</span>,<span class="st">&quot;fuel-type&quot;</span>,<span class="st">&quot;aspiration&quot;</span>, <span class="st">&quot;num-of-doors&quot;</span>,<span class="st">&quot;body-style&quot;</span>,</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;drive-wheels&quot;</span>,<span class="st">&quot;engine-location&quot;</span>,<span class="st">&quot;wheel-base&quot;</span>, <span class="st">&quot;length&quot;</span>,<span class="st">&quot;width&quot;</span>,<span class="st">&quot;height&quot;</span>,<span class="st">&quot;curb-weight&quot;</span>,<span class="st">&quot;engine-type&quot;</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;num-of-cylinders&quot;</span>, <span class="st">&quot;engine-size&quot;</span>,<span class="st">&quot;fuel-system&quot;</span>,<span class="st">&quot;bore&quot;</span>,<span class="st">&quot;stroke&quot;</span>,<span class="st">&quot;compression-ratio&quot;</span>,<span class="st">&quot;horsepower&quot;</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>         <span class="st">&quot;peak-rpm&quot;</span>,<span class="st">&quot;city-mpg&quot;</span>,<span class="st">&quot;highway-mpg&quot;</span>,<span class="st">&quot;price&quot;</span>]</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>df.columns <span class="op">=</span> headers</span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>df.head(<span class="dv">10</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="178">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>fuel-type</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>...</th>
      <th>engine-size</th>
      <th>fuel-system</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression-ratio</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>13495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>?</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>152</td>
      <td>mpfi</td>
      <td>2.68</td>
      <td>3.47</td>
      <td>9.0</td>
      <td>154</td>
      <td>5000</td>
      <td>19</td>
      <td>26</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>109</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>10.0</td>
      <td>102</td>
      <td>5500</td>
      <td>24</td>
      <td>30</td>
      <td>13950</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.0</td>
      <td>115</td>
      <td>5500</td>
      <td>18</td>
      <td>22</td>
      <td>17450</td>
    </tr>
    <tr>
      <th>5</th>
      <td>2</td>
      <td>?</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.5</td>
      <td>110</td>
      <td>5500</td>
      <td>19</td>
      <td>25</td>
      <td>15250</td>
    </tr>
    <tr>
      <th>6</th>
      <td>1</td>
      <td>158</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>105.8</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.5</td>
      <td>110</td>
      <td>5500</td>
      <td>19</td>
      <td>25</td>
      <td>17710</td>
    </tr>
    <tr>
      <th>7</th>
      <td>1</td>
      <td>?</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>wagon</td>
      <td>fwd</td>
      <td>front</td>
      <td>105.8</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.5</td>
      <td>110</td>
      <td>5500</td>
      <td>19</td>
      <td>25</td>
      <td>18920</td>
    </tr>
    <tr>
      <th>8</th>
      <td>1</td>
      <td>158</td>
      <td>audi</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>105.8</td>
      <td>...</td>
      <td>131</td>
      <td>mpfi</td>
      <td>3.13</td>
      <td>3.40</td>
      <td>8.3</td>
      <td>140</td>
      <td>5500</td>
      <td>17</td>
      <td>20</td>
      <td>23875</td>
    </tr>
    <tr>
      <th>9</th>
      <td>0</td>
      <td>?</td>
      <td>audi</td>
      <td>gas</td>
      <td>turbo</td>
      <td>two</td>
      <td>hatchback</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.5</td>
      <td>...</td>
      <td>131</td>
      <td>mpfi</td>
      <td>3.13</td>
      <td>3.40</td>
      <td>7.0</td>
      <td>160</td>
      <td>5500</td>
      <td>16</td>
      <td>22</td>
      <td>?</td>
    </tr>
  </tbody>
</table>
<p>10 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>View column names</strong></p>
</div>
<div class="cell code" data-execution_count="179">
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>df.columns</span></code></pre></div>
<div class="output execute_result" data-execution_count="179">
<pre><code>Index([&#39;symboling&#39;, &#39;normalized-losses&#39;, &#39;make&#39;, &#39;fuel-type&#39;, &#39;aspiration&#39;,
       &#39;num-of-doors&#39;, &#39;body-style&#39;, &#39;drive-wheels&#39;, &#39;engine-location&#39;,
       &#39;wheel-base&#39;, &#39;length&#39;, &#39;width&#39;, &#39;height&#39;, &#39;curb-weight&#39;, &#39;engine-type&#39;,
       &#39;num-of-cylinders&#39;, &#39;engine-size&#39;, &#39;fuel-system&#39;, &#39;bore&#39;, &#39;stroke&#39;,
       &#39;compression-ratio&#39;, &#39;horsepower&#39;, &#39;peak-rpm&#39;, &#39;city-mpg&#39;,
       &#39;highway-mpg&#39;, &#39;price&#39;],
      dtype=&#39;object&#39;)</code></pre>
</div>
</div>
<div class="cell markdown">
<p>As we can see, several question marks appeared in the dataframe; those are missing values which may hinder our further analysis.</p>
<div>So, how do we identify all those missing values and deal with them?</div>
<p><b>How to work with missing data?</b></p>
<p>Steps for working with missing data:</p>
<ol>
    <li>identify missing data</li>
    <li>deal with missing data</li>
    <li>correct data format</li>
</ol>
<p><b>we need to replace the "?" symbol with NaN so the dropna() can remove the missing values</b></p>
</div>
<div class="cell code" data-execution_count="180">
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df<span class="op">=</span>df.replace(<span class="st">&#39;?&#39;</span>,np.NaN)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>df</span></code></pre></div>
<div class="output execute_result" data-execution_count="180">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>fuel-type</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>...</th>
      <th>engine-size</th>
      <th>fuel-system</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression-ratio</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>NaN</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>13495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>NaN</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>NaN</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>152</td>
      <td>mpfi</td>
      <td>2.68</td>
      <td>3.47</td>
      <td>9.0</td>
      <td>154</td>
      <td>5000</td>
      <td>19</td>
      <td>26</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>109</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>10.0</td>
      <td>102</td>
      <td>5500</td>
      <td>24</td>
      <td>30</td>
      <td>13950</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.0</td>
      <td>115</td>
      <td>5500</td>
      <td>18</td>
      <td>22</td>
      <td>17450</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>200</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>23</td>
      <td>28</td>
      <td>16845</td>
    </tr>
    <tr>
      <th>201</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>8.7</td>
      <td>160</td>
      <td>5300</td>
      <td>19</td>
      <td>25</td>
      <td>19045</td>
    </tr>
    <tr>
      <th>202</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>173</td>
      <td>mpfi</td>
      <td>3.58</td>
      <td>2.87</td>
      <td>8.8</td>
      <td>134</td>
      <td>5500</td>
      <td>18</td>
      <td>23</td>
      <td>21485</td>
    </tr>
    <tr>
      <th>203</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>diesel</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>145</td>
      <td>idi</td>
      <td>3.01</td>
      <td>3.40</td>
      <td>23.0</td>
      <td>106</td>
      <td>4800</td>
      <td>26</td>
      <td>27</td>
      <td>22470</td>
    </tr>
    <tr>
      <th>204</th>
      <td>-1</td>
      <td>95</td>
      <td>volvo</td>
      <td>gas</td>
      <td>turbo</td>
      <td>four</td>
      <td>sedan</td>
      <td>rwd</td>
      <td>front</td>
      <td>109.1</td>
      <td>...</td>
      <td>141</td>
      <td>mpfi</td>
      <td>3.78</td>
      <td>3.15</td>
      <td>9.5</td>
      <td>114</td>
      <td>5400</td>
      <td>19</td>
      <td>25</td>
      <td>22625</td>
    </tr>
  </tbody>
</table>
<p>205 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
Identify_missing_values

<h4>Evaluating for Missing Data</h4>

The missing values are converted to default. We use the following functions to identify these missing values. There are two methods to detect missing data:

<ol>
    <li><b>.isnull()</b></li>
    <li><b>.notnull()</b></li>
</ol>
The output is a boolean value indicating whether the value that is passed into the argument is in fact missing data.
</div>
</div>
<div class="cell code" data-execution_count="181">
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>missing_data <span class="op">=</span> df.isnull()</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>missing_data.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="181">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>fuel-type</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>...</th>
      <th>engine-size</th>
      <th>fuel-system</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression-ratio</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>False</td>
      <td>True</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>3</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
    <tr>
      <th>4</th>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>...</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b><code>True</code> stands for missing value, while <code>False</code> stands for not missing value.</b>
<h4><code>Count missing values in each column</code></h4>
<p>
Using a for loop in Python, we can quickly figure out the number of missing values in each column. As mentioned above, "True" represents a missing value, "False"  means the value is present in the dataset.  In the body of the for loop the method  ".value_counts()"  counts the number of "True" values. 
</p>
</div>
</div>
<div class="cell code" data-execution_count="182">
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> missing_data.columns:</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(column)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span> (missing_data[column].value_counts())</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;&quot;</span>)    </span></code></pre></div>
<div class="output stream stdout">
<pre><code>symboling
False    205
Name: symboling, dtype: int64

normalized-losses
False    164
True      41
Name: normalized-losses, dtype: int64

make
False    205
Name: make, dtype: int64

fuel-type
False    205
Name: fuel-type, dtype: int64

aspiration
False    205
Name: aspiration, dtype: int64

num-of-doors
False    203
True       2
Name: num-of-doors, dtype: int64

body-style
False    205
Name: body-style, dtype: int64

drive-wheels
False    205
Name: drive-wheels, dtype: int64

engine-location
False    205
Name: engine-location, dtype: int64

wheel-base
False    205
Name: wheel-base, dtype: int64

length
False    205
Name: length, dtype: int64

width
False    205
Name: width, dtype: int64

height
False    205
Name: height, dtype: int64

curb-weight
False    205
Name: curb-weight, dtype: int64

engine-type
False    205
Name: engine-type, dtype: int64

num-of-cylinders
False    205
Name: num-of-cylinders, dtype: int64

engine-size
False    205
Name: engine-size, dtype: int64

fuel-system
False    205
Name: fuel-system, dtype: int64

bore
False    201
True       4
Name: bore, dtype: int64

stroke
False    201
True       4
Name: stroke, dtype: int64

compression-ratio
False    205
Name: compression-ratio, dtype: int64

horsepower
False    203
True       2
Name: horsepower, dtype: int64

peak-rpm
False    203
True       2
Name: peak-rpm, dtype: int64

city-mpg
False    205
Name: city-mpg, dtype: int64

highway-mpg
False    205
Name: highway-mpg, dtype: int64

price
False    201
True       4
Name: price, dtype: int64

</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b> Based on the summary above, each column has 205 rows of data, seven columns containing missing data:</b>
<ol>
    <li>"normalized-losses": 41 missing data</li>
    <li>"num-of-doors": 2 missing data</li>
    <li>"bore": 4 missing data</li>
    <li>"stroke" : 4 missing data</li>
    <li>"horsepower": 2 missing data</li>
    <li>"peak-rpm": 2 missing data</li>
    <li>"price": 4 missing data</li>
</ol>
</div>
<h3 id="deal-with-missing-data"><code>Deal with missing data</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>How to deal with missing data?</b>

<ol>
    <li>drop data<br>
        a. drop the whole row<br>
        b. drop the whole column
    </li>
    <li>replace data<br>
        a. replace it by mean<br>
        b. replace it by frequency<br>
        c. replace it based on other functions
    </li><br>
    
Whole columns should be dropped only if most entries in the column are empty. In our dataset, none of the columns are empty enough to drop entirely.
We have some freedom in choosing which method to replace data; however, some methods may seem more reasonable than others. We will apply each method to many different columns:

<b>Replace by mean:</b>

<ul>
    <li>"normalized-losses": 41 missing data, replace them with mean</li>
    <li>"stroke": 4 missing data, replace them with mean</li>
    <li>"bore": 4 missing data, replace them with mean</li>
    <li>"horsepower": 2 missing data, replace them with mean</li>
    <li>"peak-rpm": 2 missing data, replace them with mean</li>
</ul>

<b>Replace by frequency:</b>

<ul>
    <li>"num-of-doors": 2 missing data, replace them with "four". 
        <ul>
            <li>Reason: 84% sedans is four doors. Since four doors is most frequent, it is most likely to occur</li>
        </ul>
    </li>
</ul>

<b>Drop the whole row:</b>

<ul>
    <li>"price": 4 missing data, simply delete the whole row
        <ul>
            <li>Reason: price is what we want to predict. Any data entry without price data cannot be used for prediction; therefore any row now without price data is not useful to us</li>
        </ul>
    </li>
</ul>

</ol>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>Replace by mean:</b>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"normalized-losses": 41 missing data, replace them with mean</b>
</div>
</div>
<div class="cell code" data-execution_count="183">
<div class="sourceCode" id="cb14"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate the average of the column</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>avg_norm_loss <span class="op">=</span> df[<span class="st">&quot;normalized-losses&quot;</span>].astype(<span class="st">&quot;float&quot;</span>).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Average of normalized-losses:&quot;</span>, avg_norm_loss)</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace &quot;NaN&quot; by mean value in &quot;normalized-losses&quot; column</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;normalized-losses&quot;</span>].replace(np.nan, avg_norm_loss, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Average of normalized-losses: 122.0
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"bore": 4 missing data, replace them with mean</b>
</div>
</div>
<div class="cell code" data-execution_count="184">
<div class="sourceCode" id="cb16"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the mean value for &#39;bore&#39; column</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>avg_bore<span class="op">=</span>df[<span class="st">&#39;bore&#39;</span>].astype(<span class="st">&#39;float&#39;</span>).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Average of bore:&quot;</span>, avg_bore)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace NaN by mean value</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;bore&quot;</span>].replace(np.nan, avg_bore, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Average of bore: 3.3297512437810943
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"stroke": 4 missing data, replace them with mean</b>
</div>
</div>
<div class="cell code" data-execution_count="185">
<div class="sourceCode" id="cb18"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the mean vaule for &quot;stroke&quot; column</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>avg_stroke <span class="op">=</span> df[<span class="st">&quot;stroke&quot;</span>].astype(<span class="st">&quot;float&quot;</span>).mean(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Average of stroke:&quot;</span>, avg_stroke)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace &quot;stroke&quot; by mean value</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;stroke&quot;</span>].replace(np.nan, avg_stroke, inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Average of stroke: 3.255422885572139
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"peak-rpm": 2 missing data, replace them with mean</b>
</div>
</div>
<div class="cell code" data-execution_count="186">
<div class="sourceCode" id="cb20"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the mean vaule for &quot;peak-rpm&quot; column</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>avg_peak_rpm <span class="op">=</span> df[<span class="st">&quot;peak-rpm&quot;</span>].astype(<span class="st">&quot;float&quot;</span>).mean(axis <span class="op">=</span> <span class="dv">0</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Average of peak-rpm:&quot;</span>, avg_peak_rpm)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace &quot;peak-rpm&quot; by mean value</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;peak-rpm&quot;</span>].replace(np.nan, avg_peak_rpm, inplace <span class="op">=</span> <span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Average of peak-rpm: 5125.369458128079
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"horsepower": 2 missing data, replace them with mean</b>
</div>
</div>
<div class="cell code" data-execution_count="187">
<div class="sourceCode" id="cb22"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Calculate the mean vaule for &quot;horsepower&quot; column</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>avg_horsepower <span class="op">=</span> df[<span class="st">&#39;horsepower&#39;</span>].astype(<span class="st">&#39;float&#39;</span>).mean(axis<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Average horsepower:&quot;</span>, avg_horsepower)</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Replace &quot;horsepower&quot; by mean value</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;horsepower&#39;</span>].replace(np.nan, avg_horsepower, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Average horsepower: 104.25615763546799
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>Replace by frequency:</b>
</div>
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>"num-of-doors": 2 missing data</b>
</div>
<p><strong>To see which values are present in a particular column, we can use the <code>.value_counts()</code> method:</strong></p>
</div>
<div class="cell code" data-execution_count="188">
<div class="sourceCode" id="cb24"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;num-of-doors&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="188">
<pre><code>four    114
two      89
Name: num-of-doors, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can see that four doors are the most common type. We can also use the <code>.idxmax()</code> method to calculate for us the most common type automatically:</strong></p>
</div>
<div class="cell code" data-execution_count="189">
<div class="sourceCode" id="cb26"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;num-of-doors&#39;</span>].value_counts().idxmax()</span></code></pre></div>
<div class="output execute_result" data-execution_count="189">
<pre><code>&#39;four&#39;</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>The replacement procedure is very similar to what we have seen previously</strong></p>
</div>
<div class="cell code" data-execution_count="190">
<div class="sourceCode" id="cb28"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co">#replace the missing &#39;num-of-doors&#39; values by the most frequent </span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;num-of-doors&quot;</span>].replace(np.nan, <span class="st">&quot;four&quot;</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>Finally, let's drop all rows that do not have price data:</b>
</div>
</div>
<div class="cell code" data-execution_count="191">
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simply drop whole row with NaN in &quot;price&quot; column</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>df.dropna(subset<span class="op">=</span>[<span class="st">&quot;price&quot;</span>], axis<span class="op">=</span><span class="dv">0</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="co"># reset index, because we droped two rows</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>df.reset_index(drop<span class="op">=</span><span class="va">True</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="192">
<div class="sourceCode" id="cb30"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="192">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>fuel-type</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>...</th>
      <th>engine-size</th>
      <th>fuel-system</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression-ratio</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>122.0</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>13495</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>122.0</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>130</td>
      <td>mpfi</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000</td>
      <td>21</td>
      <td>27</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>122.0</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>152</td>
      <td>mpfi</td>
      <td>2.68</td>
      <td>3.47</td>
      <td>9.0</td>
      <td>154</td>
      <td>5000</td>
      <td>19</td>
      <td>26</td>
      <td>16500</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>109</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>10.0</td>
      <td>102</td>
      <td>5500</td>
      <td>24</td>
      <td>30</td>
      <td>13950</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>...</td>
      <td>136</td>
      <td>mpfi</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.0</td>
      <td>115</td>
      <td>5500</td>
      <td>18</td>
      <td>22</td>
      <td>17450</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 26 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<h3 id="correct_data_format"><code>Correct data format</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>We are almost there!</b>
<p>The last step in data cleaning is checking and making sure that all data is in the correct format (int, float, text or other).</p>

<h3><code>Data Types</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>
Data has a variety of types.<br>
The main types stored in Pandas dataframes are <b>object</b>, <b>float</b>, <b>int</b>, <b>bool</b> and <b>datetime64</b>. In order to better learn about each attribute, it is always good for us to know the data type of each column. In Pandas:
</p>
</div>
In Pandas, we use 

<p><b>.dtype()</b> to check the data type</p>
<p><b>.astype()</b> to change the data type</p>
</div>
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>Lets list the data types for each column</b>
</div>
</div>
<div class="cell code" data-execution_count="193">
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>df.dtypes</span></code></pre></div>
<div class="output execute_result" data-execution_count="193">
<pre><code>symboling              int64
normalized-losses     object
make                  object
fuel-type             object
aspiration            object
num-of-doors          object
body-style            object
drive-wheels          object
engine-location       object
wheel-base           float64
length               float64
width                float64
height               float64
curb-weight            int64
engine-type           object
num-of-cylinders      object
engine-size            int64
fuel-system           object
bore                  object
stroke                object
compression-ratio    float64
horsepower            object
peak-rpm              object
city-mpg               int64
highway-mpg            int64
price                 object
dtype: object</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<p>As we can see above, some columns are not of the correct data type. Numerical variables should have type 'float' or 'int', and variables with strings such as categories should have type 'object'. For example, <code>'bore' and 'stroke' variables are numerical values that describe the engines, so we should expect them to be of the type 'float' or 'int'; however, they are shown as type 'object'</code>. We have to convert data types into a proper format for each column using the <code>astype()</code> method.</p> 
</div>
</div>
<div class="cell code" data-execution_count="194">
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Convert data types to proper format</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;bore&quot;</span>, <span class="st">&quot;stroke&quot;</span>,<span class="st">&quot;price&quot;</span>,<span class="st">&quot;peak-rpm&quot;</span>]] <span class="op">=</span> df[[<span class="st">&quot;bore&quot;</span>, <span class="st">&quot;stroke&quot;</span>,<span class="st">&quot;price&quot;</span>,<span class="st">&quot;peak-rpm&quot;</span>]].astype(<span class="st">&quot;float&quot;</span>)</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;normalized-losses&quot;</span>]] <span class="op">=</span> df[[<span class="st">&quot;normalized-losses&quot;</span>]].astype(<span class="st">&quot;int&quot;</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>Let us list the columns after the conversion</strong></p>
</div>
<div class="cell code" data-execution_count="195">
<div class="sourceCode" id="cb34"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>df.info(verbose <span class="op">=</span> <span class="va">False</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 201 entries, 0 to 200
Columns: 26 entries, symboling to price
dtypes: float64(9), int32(1), int64(5), object(11)
memory usage: 40.2+ KB
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="196">
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>df.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 201 entries, 0 to 200
Data columns (total 26 columns):
 #   Column             Non-Null Count  Dtype  
---  ------             --------------  -----  
 0   symboling          201 non-null    int64  
 1   normalized-losses  201 non-null    int32  
 2   make               201 non-null    object 
 3   fuel-type          201 non-null    object 
 4   aspiration         201 non-null    object 
 5   num-of-doors       201 non-null    object 
 6   body-style         201 non-null    object 
 7   drive-wheels       201 non-null    object 
 8   engine-location    201 non-null    object 
 9   wheel-base         201 non-null    float64
 10  length             201 non-null    float64
 11  width              201 non-null    float64
 12  height             201 non-null    float64
 13  curb-weight        201 non-null    int64  
 14  engine-type        201 non-null    object 
 15  num-of-cylinders   201 non-null    object 
 16  engine-size        201 non-null    int64  
 17  fuel-system        201 non-null    object 
 18  bore               201 non-null    float64
 19  stroke             201 non-null    float64
 20  compression-ratio  201 non-null    float64
 21  horsepower         201 non-null    object 
 22  peak-rpm           201 non-null    float64
 23  city-mpg           201 non-null    int64  
 24  highway-mpg        201 non-null    int64  
 25  price              201 non-null    float64
dtypes: float64(9), int32(1), int64(5), object(11)
memory usage: 40.2+ KB
</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-block alert-info" style="margin-top: 20px">
<b>Wonderful!</b>

Now, we finally obtain the cleaned dataset with no missing values and all data in its proper format. 
</div>
<h2 id="data_standardization"><code>Data Standardization</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>
Data is usually collected from different agencies with different formats.
(Data Standardization is also a term for a particular type of data normalization, where we subtract the mean and divide by the standard deviation)
</p>
    
<b>What is Standardization?</b>
<p>Standardization is the process of transforming data into a common format which allows the researcher to make the meaningful comparison.
</p>

<b>Example</b>

<p>Transform mpg to L/100km:</p>
<p>In our dataset, the fuel consumption columns "city-mpg" and "highway-mpg" are represented by mpg (miles per gallon) unit. Assume we are developing an application in a country that accept the fuel consumption with L/100km standard</p>
<p>We will need to apply <b>data transformation</b> to transform mpg into L/100km?</p>
    
<p>The formula for unit conversion is<p>
L/100km = 235 / mpg
<p>We can do many mathematical operations directly in Pandas.</p></div>
</div>
<div class="cell code" data-execution_count="197">
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Convert mpg to L/100km by mathematical operation (235 divided by mpg)</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;city-L/100km&#39;</span>] <span class="op">=</span> <span class="dv">235</span><span class="op">/</span>df[<span class="st">&quot;city-mpg&quot;</span>]</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;highway-L/100km&quot;</span>] <span class="op">=</span> <span class="dv">235</span><span class="op">/</span>df[<span class="st">&quot;highway-mpg&quot;</span>]</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a><span class="co"># check your transformed data </span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="197">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>fuel-type</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>...</th>
      <th>bore</th>
      <th>stroke</th>
      <th>compression-ratio</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000.0</td>
      <td>21</td>
      <td>27</td>
      <td>13495.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>...</td>
      <td>3.47</td>
      <td>2.68</td>
      <td>9.0</td>
      <td>111</td>
      <td>5000.0</td>
      <td>21</td>
      <td>27</td>
      <td>16500.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>gas</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>...</td>
      <td>2.68</td>
      <td>3.47</td>
      <td>9.0</td>
      <td>154</td>
      <td>5000.0</td>
      <td>19</td>
      <td>26</td>
      <td>16500.0</td>
      <td>12.368421</td>
      <td>9.038462</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>...</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>10.0</td>
      <td>102</td>
      <td>5500.0</td>
      <td>24</td>
      <td>30</td>
      <td>13950.0</td>
      <td>9.791667</td>
      <td>7.833333</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>gas</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>...</td>
      <td>3.19</td>
      <td>3.40</td>
      <td>8.0</td>
      <td>115</td>
      <td>5500.0</td>
      <td>18</td>
      <td>22</td>
      <td>17450.0</td>
      <td>13.055556</td>
      <td>10.681818</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<h2 id="data_normalization"><code>Data Normalization</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>Why normalization?</b>

<p>Normalization is the process of transforming values of several variables into a similar range. Typical normalizations include scaling the variable so the variable average is 0, scaling the variable so the variance is 1, or scaling variable so the variable values range from 0 to 1
</p>

<b>Example</b>

<p>To demonstrate normalization, let's say we want to scale the columns "length", "width" and "height" </p>
<p><b>Target:</b>would like to Normalize those variables so their value ranges from 0 to 1.</p>
<p><b>Approach:</b> replace original value by (original value)/(maximum value)</p>

</div>
</div>
<div class="cell code" data-execution_count="198">
<div class="sourceCode" id="cb39"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;length&quot;</span>,<span class="st">&quot;width&quot;</span>,<span class="st">&quot;height&quot;</span>]].head() <span class="co"># these values vary highly w.r.t rest column values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="198">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>length</th>
      <th>width</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>168.8</td>
      <td>64.1</td>
      <td>48.8</td>
    </tr>
    <tr>
      <th>1</th>
      <td>168.8</td>
      <td>64.1</td>
      <td>48.8</td>
    </tr>
    <tr>
      <th>2</th>
      <td>171.2</td>
      <td>65.5</td>
      <td>52.4</td>
    </tr>
    <tr>
      <th>3</th>
      <td>176.6</td>
      <td>66.2</td>
      <td>54.3</td>
    </tr>
    <tr>
      <th>4</th>
      <td>176.6</td>
      <td>66.4</td>
      <td>54.3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="199">
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># replace (original value) by (original value)/(maximum value) -&gt; Simple Feature Scaling</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;length&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;length&#39;</span>]<span class="op">/</span>df[<span class="st">&#39;length&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;width&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;width&#39;</span>]<span class="op">/</span>df[<span class="st">&#39;width&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;height&#39;</span>] <span class="op">=</span> df[<span class="st">&#39;height&#39;</span>]<span class="op">/</span>df[<span class="st">&#39;height&#39;</span>].<span class="bu">max</span>()</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a><span class="co"># show the scaled columns</span></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;length&quot;</span>,<span class="st">&quot;width&quot;</span>,<span class="st">&quot;height&quot;</span>]].head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="199">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>length</th>
      <th>width</th>
      <th>height</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.811148</td>
      <td>0.890278</td>
      <td>0.816054</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.811148</td>
      <td>0.890278</td>
      <td>0.816054</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.822681</td>
      <td>0.909722</td>
      <td>0.876254</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.848630</td>
      <td>0.919444</td>
      <td>0.908027</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.848630</td>
      <td>0.922222</td>
      <td>0.908027</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<h2 id="binning"><code>Binning</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>Why binning?</b>
<p>
    Binning is a process of transforming continuous numerical variables into discrete categorical 'bins', for grouped analysis.
</p>

<b>Example: </b>

<p>In our dataset, "horsepower" is a real valued variable ranging from 48 to 288, it has 57 unique values. What if we only care about the price difference between cars with high horsepower, medium horsepower, and little horsepower (3 types)? Can we rearrange them into three ‘bins' to simplify analysis? </p>

<p>We will use the Pandas method 'cut' to segment the 'horsepower' column into 3 bins </p>
</div>
</div>
<div class="cell markdown">
<h3>Example of Binning Data In Pandas</h3>
<p>Convert data to correct format</p>
<p>Lets plot the histogram of horspower, to see what the distribution of horsepower looks like.</p>
</div>
<div class="cell code" data-execution_count="200">
<div class="sourceCode" id="cb41"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;horsepower&quot;</span>]<span class="op">=</span>df[<span class="st">&quot;horsepower&quot;</span>].astype(<span class="bu">int</span>, copy<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df[<span class="st">&quot;horsepower&quot;</span>])</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set x/y labels and plot title</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;horsepower&quot;</span>)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;count&quot;</span>)</span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;horsepower bins&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="200">
<pre><code>Text(0.5, 1.0, &#39;horsepower bins&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/374d1b8aa9026137e7546147466a9ddcd59366bc.png" /></p>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>We would like 3 bins of equal size bandwidth so we use numpy's <code>linspace(start_value, end_value, numbers_generated)</code> function.</p>
<p>Since we want to include the minimum value of horsepower we want to set start_value=min(df["horsepower"]).</p>
<p>Since we want to include the maximum value of horsepower we want to set end_value=max(df["horsepower"]).</p>
<p>Since we are building 3 bins of equal length, there should be 4 dividers, so numbers_generated=4.</p>
</div>
</div>
<div class="cell markdown">
<p><strong>We build a bin array, with a minimum value to a maximum value, with bandwidth calculated above. The bins will be values used to determine when one bin ends and another begins.</strong></p>
</div>
<div class="cell code" data-execution_count="201">
<div class="sourceCode" id="cb43"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>bins <span class="op">=</span> np.linspace(<span class="bu">min</span>(df[<span class="st">&quot;horsepower&quot;</span>]), <span class="bu">max</span>(df[<span class="st">&quot;horsepower&quot;</span>]), <span class="dv">4</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>bins</span></code></pre></div>
<div class="output execute_result" data-execution_count="201">
<pre><code>array([ 48.        , 119.33333333, 190.66666667, 262.        ])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We set group names:</strong></p>
</div>
<div class="cell code" data-execution_count="202">
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>group_names <span class="op">=</span> [<span class="st">&#39;Low&#39;</span>, <span class="st">&#39;Medium&#39;</span>, <span class="st">&#39;High&#39;</span>]</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We apply the function <code>cut</code> that determine what each value of <code>df['horsepower']</code> belongs to.</strong></p>
</div>
<div class="cell code" data-execution_count="203">
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;horsepower-binned&#39;</span>] <span class="op">=</span> pd.cut(df[<span class="st">&#39;horsepower&#39;</span>], bins, labels<span class="op">=</span>group_names, include_lowest<span class="op">=</span><span class="va">True</span> )</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Lets see the number of vehicles in each bin</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;horsepower-binned&quot;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="203">
<pre><code>Low       153
Medium     43
High        5
Name: horsepower-binned, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Lets plot the distribution of each bin.</strong></p>
</div>
<div class="cell code" data-execution_count="204">
<div class="sourceCode" id="cb48"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>pyplot.bar(group_names, df[<span class="st">&quot;horsepower-binned&quot;</span>].value_counts())</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="co"># set x/y labels and plot title</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;horsepower&quot;</span>)</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;count&quot;</span>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;horsepower bins&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="204">
<pre><code>Text(0.5, 1.0, &#39;horsepower bins&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/441a7bebfe62ff5d69aaff7824d76aece98ccef4.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>Check the dataframe above carefully, you will find the last column provides the bins for "horsepower" with 3 categories ("Low","Medium" and "High")</strong></p>
<h3>Bins visualization</h3>
<p>Normally, a histogram is used to visualize the distribution of bins we created above.</p>
</div>
<div class="cell code" data-execution_count="205">
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co"># draw historgram of attribute &quot;horsepower&quot; with bins = 3</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>plt.hist(df[<span class="st">&quot;horsepower&quot;</span>], bins <span class="op">=</span> <span class="dv">3</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="co"># set x/y labels and plot title</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;horsepower&quot;</span>)</span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;count&quot;</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;horsepower bins&quot;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="205">
<pre><code>Text(0.5, 1.0, &#39;horsepower bins&#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/4749c4951dc31371890c341cc6a74bf5200f1665.png" /></p>
</div>
</div>
<div class="cell markdown">
<h2 id="indicator"><code>Indicator variable (or dummy variable)</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<b>What is an indicator variable?</b>
<p>
    An indicator variable (or dummy variable) is a numerical variable used to label categories. They are called 'dummies' because the numbers themselves don't have inherent meaning. 
</p>

<b>Why we use indicator variables?</b>

<p>
    So we can use categorical variables for regression analysis in the later modules.
</p>
<b>Example</b>
<p>
    We see the column "fuel-type" has two unique values, "gas" or "diesel". Regression doesn't understand words, only numbers. To use this attribute in regression analysis, we convert "fuel-type" into indicator variables.
</p>

<p>
    We will use the panda's method 'get_dummies' to assign numerical values to different categories of fuel type. 
</p>

</div>
</div>
<div class="cell markdown">
<p><strong>get indicator variables as <code>fuel-type</code> and assign it to data frame <code>dummy_variable_1</code></strong></p>
</div>
<div class="cell code" data-execution_count="206">
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>dummy_variable_1 <span class="op">=</span> pd.get_dummies(df[<span class="st">&quot;fuel-type&quot;</span>])</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>dummy_variable_1.sample(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="206">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>diesel</th>
      <th>gas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>143</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>197</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>110</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>61</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>112</th>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>change column names for clarity</strong></p>
</div>
<div class="cell code" data-execution_count="207">
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>dummy_variable_1.rename(columns<span class="op">=</span>{<span class="st">&#39;gas&#39;</span>:<span class="st">&#39;fuel-type-gas&#39;</span>, <span class="st">&#39;diesel&#39;</span>:<span class="st">&#39;fuel-type-diesel&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>dummy_variable_1.head(<span class="dv">5</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="207">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>In the dataframe, column fuel-type has a value for 'gas' and 'diesel'as 0s and 1s now</strong></p>
</div>
<div class="cell code" data-execution_count="208">
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge data frame &quot;df&quot; and &quot;dummy_variable_1&quot; </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([df, dummy_variable_1], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="co"># drop original column &quot;fuel-type&quot; from &quot;df&quot;</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">&quot;fuel-type&quot;</span>, axis <span class="op">=</span> <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="209">
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="209">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>aspiration</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>length</th>
      <th>...</th>
      <th>horsepower</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
      <th>horsepower-binned</th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>0.811148</td>
      <td>...</td>
      <td>111</td>
      <td>5000.0</td>
      <td>21</td>
      <td>27</td>
      <td>13495.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>std</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>0.811148</td>
      <td>...</td>
      <td>111</td>
      <td>5000.0</td>
      <td>21</td>
      <td>27</td>
      <td>16500.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>std</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>0.822681</td>
      <td>...</td>
      <td>154</td>
      <td>5000.0</td>
      <td>19</td>
      <td>26</td>
      <td>16500.0</td>
      <td>12.368421</td>
      <td>9.038462</td>
      <td>Medium</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>0.848630</td>
      <td>...</td>
      <td>102</td>
      <td>5500.0</td>
      <td>24</td>
      <td>30</td>
      <td>13950.0</td>
      <td>9.791667</td>
      <td>7.833333</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>std</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>0.848630</td>
      <td>...</td>
      <td>115</td>
      <td>5500.0</td>
      <td>18</td>
      <td>22</td>
      <td>17450.0</td>
      <td>13.055556</td>
      <td>10.681818</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 30 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>Repeat for <code>aspiration</code> column</strong></p>
</div>
<div class="cell code" data-execution_count="210">
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get indicator variables of aspiration and assign it to data frame &quot;dummy_variable_2&quot;</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>dummy_variable_2 <span class="op">=</span> pd.get_dummies(df[<span class="st">&#39;aspiration&#39;</span>])</span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="co"># change column names for clarity</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>dummy_variable_2.rename(columns<span class="op">=</span>{<span class="st">&#39;std&#39;</span>:<span class="st">&#39;aspiration-std&#39;</span>, <span class="st">&#39;turbo&#39;</span>: <span class="st">&#39;aspiration-turbo&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="co"># show first 5 instances of data frame &quot;dummy_variable_1&quot;</span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>dummy_variable_2.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="210">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>aspiration-std</th>
      <th>aspiration-turbo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell code" data-execution_count="211">
<div class="sourceCode" id="cb57"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge data frame &quot;df&quot; and &quot;dummy_variable_1&quot; </span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.concat([df, dummy_variable_2], axis<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="co"># drop original column &quot;fuel-type&quot; from &quot;df&quot;</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>df.drop(<span class="st">&quot;aspiration&quot;</span>, axis <span class="op">=</span> <span class="dv">1</span>, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>df.head()</span></code></pre></div>
<div class="output execute_result" data-execution_count="211">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>length</th>
      <th>width</th>
      <th>...</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
      <th>horsepower-binned</th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
      <th>aspiration-std</th>
      <th>aspiration-turbo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>0.811148</td>
      <td>0.890278</td>
      <td>...</td>
      <td>21</td>
      <td>27</td>
      <td>13495.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>two</td>
      <td>convertible</td>
      <td>rwd</td>
      <td>front</td>
      <td>88.6</td>
      <td>0.811148</td>
      <td>0.890278</td>
      <td>...</td>
      <td>21</td>
      <td>27</td>
      <td>16500.0</td>
      <td>11.190476</td>
      <td>8.703704</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>122</td>
      <td>alfa-romero</td>
      <td>two</td>
      <td>hatchback</td>
      <td>rwd</td>
      <td>front</td>
      <td>94.5</td>
      <td>0.822681</td>
      <td>0.909722</td>
      <td>...</td>
      <td>19</td>
      <td>26</td>
      <td>16500.0</td>
      <td>12.368421</td>
      <td>9.038462</td>
      <td>Medium</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>99.8</td>
      <td>0.848630</td>
      <td>0.919444</td>
      <td>...</td>
      <td>24</td>
      <td>30</td>
      <td>13950.0</td>
      <td>9.791667</td>
      <td>7.833333</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>164</td>
      <td>audi</td>
      <td>four</td>
      <td>sedan</td>
      <td>4wd</td>
      <td>front</td>
      <td>99.4</td>
      <td>0.848630</td>
      <td>0.922222</td>
      <td>...</td>
      <td>18</td>
      <td>22</td>
      <td>17450.0</td>
      <td>13.055556</td>
      <td>10.681818</td>
      <td>Low</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<hr />
</div>
<section id="analyzing-individual-feature-patterns-using-visualization" class="cell markdown">
<h1><code>Analyzing Individual Feature Patterns using Visualization</code></h1>
</section>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
<code>How to choose the right visualization method?</code><br>
When visualizing individual variables, it is important to first understand what type of variable you are dealing with. This will help us find the right visualization method for that variable.
</div>
</div>
<div class="cell code" data-execution_count="212">
<div class="sourceCode" id="cb58"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co"># list the data types for each column</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.dtypes)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>symboling               int64
normalized-losses       int32
make                   object
num-of-doors           object
body-style             object
drive-wheels           object
engine-location        object
wheel-base            float64
length                float64
width                 float64
height                float64
curb-weight             int64
engine-type            object
num-of-cylinders       object
engine-size             int64
fuel-system            object
bore                  float64
stroke                float64
compression-ratio     float64
horsepower              int32
peak-rpm              float64
city-mpg                int64
highway-mpg             int64
price                 float64
city-L/100km          float64
highway-L/100km       float64
horsepower-binned    category
fuel-type-diesel        uint8
fuel-type-gas           uint8
aspiration-std          uint8
aspiration-turbo        uint8
dtype: object
</code></pre>
</div>
</div>
<div class="cell markdown">
<h2><code>1. Continuous numerical variables:</code></h2>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>Continuous numerical variables are variables that may contain any value within some range. Continuous numerical variables can have the type <code>int64</code> or <code>float64</code>. A great way to visualize these variables is by using scatterplots with fitted lines.</p>

<p>In order to start understanding the (linear) relationship between an individual variable and the price. We can do this by using "regplot", which plots the scatterplot plus the fitted regression line for the data.</p>
</div>
</div>
<div class="cell markdown">
<h4><code>Positive linear relationship</code></h4>
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's find the scatterplot of "engine-size" and "price"
</div>
</div>
<div class="cell code" data-execution_count="213">
<div class="sourceCode" id="cb60"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> <span class="st">&#39;engine-size&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>, data <span class="op">=</span> df)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,) <span class="co"># y axis starts from zero</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;correlation between engine-size and price&quot;</span>)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/37544d22a4cbd62f669ff5fc041519d76902d898.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>As the <code>engine-size goes up, the price goes up: this indicates a positive direct correlation</code> between these two variables. Engine size seems like a pretty good predictor of price since the regression line is almost a perfect diagonal line.We can examine the correlation between engine-size and price and see it's approximately <code>0.87</code></strong></p>
<div class="alert alert-body alert-info" style="margin-top: 20px">
we can calculate the correlation between variables of type <code>int64</code> or <code>float64</code> using the method <code>corr</code>: The diagonal elements are always one
</div>
</div>
<div class="cell code" data-execution_count="214">
<div class="sourceCode" id="cb61"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&quot;engine-size&quot;</span>, <span class="st">&quot;price&quot;</span>]].corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="214">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>engine-size</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>engine-size</th>
      <td>1.000000</td>
      <td>0.872335</td>
    </tr>
    <tr>
      <th>price</th>
      <td>0.872335</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
Highway mpg is a potential predictor variable of price
</div>
<p><strong><code>Highway MPG</code>: the average a car will get while driving on an open stretch of road without stopping or starting, typically at a higher speed. <code>City MPG</code>: the score a car will get on average in city conditions, with stopping and starting at lower speeds.</strong></p>
</div>
<div class="cell code" data-execution_count="215">
<div class="sourceCode" id="cb62"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> <span class="st">&#39;highway-mpg&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>,data <span class="op">=</span> df)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;correlation between highway-mpg and price &#39;</span>)</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;highway-mpg&#39;</span>, <span class="st">&#39;price&#39;</span>]].corr()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>correlation between highway-mpg and price 
</code></pre>
</div>
<div class="output execute_result" data-execution_count="215">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>highway-mpg</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>highway-mpg</th>
      <td>1.000000</td>
      <td>-0.704692</td>
    </tr>
    <tr>
      <th>price</th>
      <td>-0.704692</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/2c3e119892b1b5d9f66c875be72ccdc1682d6ca9.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>As the <code>highway-mpg goes up, the price goes down: this indicates an inverse/negative relationship</code> between these two variables. Highway mpg could potentially be a predictor of price.We can examine the correlation between highway-mpg and price and see it's approximately <code>-0.704</code></strong></p>
</div>
<div class="cell markdown">
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
Weak Linear Relationship
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's see if <code>Peak-rpm</code> as a predictor variable of <code>price</code>
</div>
</div>
<div class="cell code" data-execution_count="216">
<div class="sourceCode" id="cb64"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> <span class="st">&#39;peak-rpm&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>, data <span class="op">=</span> df)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;correlation between peak-rpm and price &#39;</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;peak-rpm&#39;</span>,<span class="st">&#39;price&#39;</span>]].corr()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>correlation between peak-rpm and price 
</code></pre>
</div>
<div class="output execute_result" data-execution_count="216">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>peak-rpm</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>peak-rpm</th>
      <td>1.000000</td>
      <td>-0.101616</td>
    </tr>
    <tr>
      <th>price</th>
      <td>-0.101616</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/5e3f1a877dc87302c3660888dd4901d9a0aa43aa.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Peak rpm does not seem like a good predictor of the price at all</code> since the regression line is close to horizontal. Also, the data points are very scattered and far from the fitted line, showing lots of variability. Therefore it's it is not a reliable variable.We can examine the <code>correlation</code> between peak-rp and price and see it's approximately <code>-0.101616</code></strong></p>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's see if <code>stroke</code> as a predictor variable of <code>price</code>
</div>
</div>
<div class="cell code" data-execution_count="217">
<div class="sourceCode" id="cb66"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;correlation between strike and prce :&#39;</span>)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation results between &quot;price&quot; and &quot;stroke&quot; do you expect a linear relationship?</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> <span class="st">&#39;stroke&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>, data <span class="op">=</span> df)</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between x=&quot;stroke&quot;, y=&quot;price&quot;.</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>df[[<span class="st">&#39;stroke&#39;</span>,<span class="st">&#39;price&#39;</span>]].corr()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>correlation between strike and prce :
</code></pre>
</div>
<div class="output execute_result" data-execution_count="217">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stroke</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>stroke</th>
      <td>1.000000</td>
      <td>0.082269</td>
    </tr>
    <tr>
      <th>price</th>
      <td>0.082269</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/5088ae65cc15f5779ee70760d39612efd4a24c8c.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Stroke does not seem like a good predictor of the price at all</code> since the regression line is close to horizontal. Also, the data points are very scattered and far from the fitted line, showing lots of variability. Therefore it's it is not a reliable variable.We can examine the <code>correlation</code> between stroke and price and see it's approximately <code>0.08</code></strong></p>
</div>
<div class="cell markdown">
<h3><code>2. Categorical variables</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>These are variables that describe a <code>characteristic</code> of a data unit, and are selected from a small group of categories. The categorical variables can have the type <code>object</code> or <code>int64</code>. A good way to visualize categorical variables is by using boxplots.
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's look at the relationship between <code>body-style</code> and <code>price</code>.
</div>
</div>
<div class="cell code" data-execution_count="218">
<div class="sourceCode" id="cb68"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x<span class="op">=</span><span class="st">&quot;body-style&quot;</span>, y<span class="op">=</span><span class="st">&quot;price&quot;</span>, data<span class="op">=</span>df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="218">
<pre><code>&lt;AxesSubplot:xlabel=&#39;body-style&#39;, ylabel=&#39;price&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/a24ef6ce7f2c11593af4a73c98218e0e1daa8307.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>We see that the distributions of price between the different body-style categories have a significant overlap, and so body-style would not be a good predictor of price.</strong></p>
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's examine if <code>engine-location</code> as a predictor variable of <code>price</code> :
</div>
</div>
<div class="cell code" data-execution_count="219">
<div class="sourceCode" id="cb70"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;engine-location&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>, data <span class="op">=</span> df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="219">
<pre><code>&lt;AxesSubplot:xlabel=&#39;engine-location&#39;, ylabel=&#39;price&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/59e6f4f246c54e5e1c86d385b7808da83258b664.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>Here we see that the distribution of price between these two <code>engine-location</code> categories, front and rear, are distinct enough to take engine-location as a <code>potential good predictor of price</code>.</strong></p>
<div class="alert alert-body alert-info" style="margin-top: 20px">
Let's examine if <code>drive-wheels</code> as a predictor variable of <code>price</code> :
</div>
<p><strong>A <code>drive wheel</code> is a wheel of a motor vehicle that transmits force, transforming torque into tractive force from the tires to the road, causing the vehicle to move.</strong></p>
</div>
<div class="cell code" data-execution_count="220">
<div class="sourceCode" id="cb72"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>sns.boxplot(x <span class="op">=</span> <span class="st">&#39;drive-wheels&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>, data <span class="op">=</span> df)</span></code></pre></div>
<div class="output execute_result" data-execution_count="220">
<pre><code>&lt;AxesSubplot:xlabel=&#39;drive-wheels&#39;, ylabel=&#39;price&#39;&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/603a1f232456f55c7cda0140996ac8f8fc483883.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>Here we see that the distribution of price between the different drive-wheels categories differs; as such <code>drive-wheels could potentially be a predictor of price.</code></strong></p>
</div>
<div class="cell markdown">
<h3><code>3. Descriptive Statistical Analysis</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>Let's first take a look at the variables by utilizing a description method.</p>

<p>The <b>describe</b> function automatically computes basic statistics for all continuous variables. Any NaN values are automatically skipped in these statistics.</p>

This will show:

<ul>
    <li>the count of that variable</li>
    <li>the mean</li>
    <li>the standard deviation (std)</li> 
    <li>the minimum value</li>
    <li>the IQR (Interquartile Range: 25%, 50% and 75%)</li>
    <li>the maximum value</li>
<ul>
</div>
<p><b>We can apply the method <code>describe</code> as follows:</b></p>
</div>
<div class="cell code" data-execution_count="221">
<div class="sourceCode" id="cb74"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>df.describe()</span></code></pre></div>
<div class="output execute_result" data-execution_count="221">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>wheel-base</th>
      <th>length</th>
      <th>width</th>
      <th>height</th>
      <th>curb-weight</th>
      <th>engine-size</th>
      <th>bore</th>
      <th>stroke</th>
      <th>...</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
      <th>aspiration-std</th>
      <th>aspiration-turbo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>201.000000</td>
      <td>201.00000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>...</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.840796</td>
      <td>122.00000</td>
      <td>98.797015</td>
      <td>0.837102</td>
      <td>0.915126</td>
      <td>0.899108</td>
      <td>2555.666667</td>
      <td>126.875622</td>
      <td>3.330692</td>
      <td>3.256874</td>
      <td>...</td>
      <td>5117.665368</td>
      <td>25.179104</td>
      <td>30.686567</td>
      <td>13207.129353</td>
      <td>9.944145</td>
      <td>8.044957</td>
      <td>0.099502</td>
      <td>0.900498</td>
      <td>0.820896</td>
      <td>0.179104</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.254802</td>
      <td>31.99625</td>
      <td>6.066366</td>
      <td>0.059213</td>
      <td>0.029187</td>
      <td>0.040933</td>
      <td>517.296727</td>
      <td>41.546834</td>
      <td>0.268072</td>
      <td>0.316048</td>
      <td>...</td>
      <td>478.113805</td>
      <td>6.423220</td>
      <td>6.815150</td>
      <td>7947.066342</td>
      <td>2.534599</td>
      <td>1.840739</td>
      <td>0.300083</td>
      <td>0.300083</td>
      <td>0.384397</td>
      <td>0.384397</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.000000</td>
      <td>65.00000</td>
      <td>86.600000</td>
      <td>0.678039</td>
      <td>0.837500</td>
      <td>0.799331</td>
      <td>1488.000000</td>
      <td>61.000000</td>
      <td>2.540000</td>
      <td>2.070000</td>
      <td>...</td>
      <td>4150.000000</td>
      <td>13.000000</td>
      <td>16.000000</td>
      <td>5118.000000</td>
      <td>4.795918</td>
      <td>4.351852</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>101.00000</td>
      <td>94.500000</td>
      <td>0.801538</td>
      <td>0.890278</td>
      <td>0.869565</td>
      <td>2169.000000</td>
      <td>98.000000</td>
      <td>3.150000</td>
      <td>3.110000</td>
      <td>...</td>
      <td>4800.000000</td>
      <td>19.000000</td>
      <td>25.000000</td>
      <td>7775.000000</td>
      <td>7.833333</td>
      <td>6.911765</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>122.00000</td>
      <td>97.000000</td>
      <td>0.832292</td>
      <td>0.909722</td>
      <td>0.904682</td>
      <td>2414.000000</td>
      <td>120.000000</td>
      <td>3.310000</td>
      <td>3.290000</td>
      <td>...</td>
      <td>5125.369458</td>
      <td>24.000000</td>
      <td>30.000000</td>
      <td>10295.000000</td>
      <td>9.791667</td>
      <td>7.833333</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>137.00000</td>
      <td>102.400000</td>
      <td>0.881788</td>
      <td>0.925000</td>
      <td>0.928094</td>
      <td>2926.000000</td>
      <td>141.000000</td>
      <td>3.580000</td>
      <td>3.410000</td>
      <td>...</td>
      <td>5500.000000</td>
      <td>30.000000</td>
      <td>34.000000</td>
      <td>16500.000000</td>
      <td>12.368421</td>
      <td>9.400000</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.000000</td>
      <td>256.00000</td>
      <td>120.900000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>4066.000000</td>
      <td>326.000000</td>
      <td>3.940000</td>
      <td>4.170000</td>
      <td>...</td>
      <td>6600.000000</td>
      <td>49.000000</td>
      <td>54.000000</td>
      <td>45400.000000</td>
      <td>18.076923</td>
      <td>14.687500</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>8 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
The default setting of describe skips variables of type object. We can apply the method <code>describe</code> on the variables of type <code>object</code> as follows:
</div>
</div>
<div class="cell code" data-execution_count="222">
<div class="sourceCode" id="cb75"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df.describe(include <span class="op">=</span> [<span class="st">&#39;object&#39;</span>])</span></code></pre></div>
<div class="output execute_result" data-execution_count="222">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>make</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>engine-type</th>
      <th>num-of-cylinders</th>
      <th>fuel-system</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>22</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>7</td>
      <td>8</td>
    </tr>
    <tr>
      <th>top</th>
      <td>toyota</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>ohc</td>
      <td>four</td>
      <td>mpfi</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>32</td>
      <td>115</td>
      <td>94</td>
      <td>118</td>
      <td>198</td>
      <td>145</td>
      <td>157</td>
      <td>92</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
 We can apply the method <code>describe</code> on the variables of type <code>all datatypes</code> as follows:
</div>
</div>
<div class="cell code" data-execution_count="223">
<div class="sourceCode" id="cb76"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>df.describe(include <span class="op">=</span> <span class="st">&#39;all&#39;</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="223">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>make</th>
      <th>num-of-doors</th>
      <th>body-style</th>
      <th>drive-wheels</th>
      <th>engine-location</th>
      <th>wheel-base</th>
      <th>length</th>
      <th>width</th>
      <th>...</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
      <th>horsepower-binned</th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
      <th>aspiration-std</th>
      <th>aspiration-turbo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>201.000000</td>
      <td>201.00000</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>...</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
      <td>201.000000</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>22</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>2</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>3</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>top</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>toyota</td>
      <td>four</td>
      <td>sedan</td>
      <td>fwd</td>
      <td>front</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>Low</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>32</td>
      <td>115</td>
      <td>94</td>
      <td>118</td>
      <td>198</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>153</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>0.840796</td>
      <td>122.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>98.797015</td>
      <td>0.837102</td>
      <td>0.915126</td>
      <td>...</td>
      <td>25.179104</td>
      <td>30.686567</td>
      <td>13207.129353</td>
      <td>9.944145</td>
      <td>8.044957</td>
      <td>NaN</td>
      <td>0.099502</td>
      <td>0.900498</td>
      <td>0.820896</td>
      <td>0.179104</td>
    </tr>
    <tr>
      <th>std</th>
      <td>1.254802</td>
      <td>31.99625</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>6.066366</td>
      <td>0.059213</td>
      <td>0.029187</td>
      <td>...</td>
      <td>6.423220</td>
      <td>6.815150</td>
      <td>7947.066342</td>
      <td>2.534599</td>
      <td>1.840739</td>
      <td>NaN</td>
      <td>0.300083</td>
      <td>0.300083</td>
      <td>0.384397</td>
      <td>0.384397</td>
    </tr>
    <tr>
      <th>min</th>
      <td>-2.000000</td>
      <td>65.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>86.600000</td>
      <td>0.678039</td>
      <td>0.837500</td>
      <td>...</td>
      <td>13.000000</td>
      <td>16.000000</td>
      <td>5118.000000</td>
      <td>4.795918</td>
      <td>4.351852</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>0.000000</td>
      <td>101.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>94.500000</td>
      <td>0.801538</td>
      <td>0.890278</td>
      <td>...</td>
      <td>19.000000</td>
      <td>25.000000</td>
      <td>7775.000000</td>
      <td>7.833333</td>
      <td>6.911765</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1.000000</td>
      <td>122.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>97.000000</td>
      <td>0.832292</td>
      <td>0.909722</td>
      <td>...</td>
      <td>24.000000</td>
      <td>30.000000</td>
      <td>10295.000000</td>
      <td>9.791667</td>
      <td>7.833333</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2.000000</td>
      <td>137.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>102.400000</td>
      <td>0.881788</td>
      <td>0.925000</td>
      <td>...</td>
      <td>30.000000</td>
      <td>34.000000</td>
      <td>16500.000000</td>
      <td>12.368421</td>
      <td>9.400000</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>3.000000</td>
      <td>256.00000</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>120.900000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>...</td>
      <td>49.000000</td>
      <td>54.000000</td>
      <td>45400.000000</td>
      <td>18.076923</td>
      <td>14.687500</td>
      <td>NaN</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>11 rows × 31 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<h3><code>Value Counts</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
Value-counts is a good way of understanding how many units of each characteristic/variable we have. We can apply the <code>value_counts</code> method on the column 'drive-wheels'. Don’t forget the method <code>value_counts</code> only works on Pandas series, not Pandas Dataframes. As a result, we only include one bracket <code>df['drive-wheels']</code> not two brackets <code>df[['drive-wheels']]</code>.
</div>
</div>
<div class="cell code" data-execution_count="224">
<div class="sourceCode" id="cb77"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;drive-wheels&#39;</span>].value_counts()</span></code></pre></div>
<div class="output execute_result" data-execution_count="224">
<pre><code>fwd    118
rwd     75
4wd      8
Name: drive-wheels, dtype: int64</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can convert the series to a Dataframe as follows :</strong></p>
</div>
<div class="cell code" data-execution_count="225">
<div class="sourceCode" id="cb79"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&#39;drive-wheels&#39;</span>].value_counts().to_frame()</span></code></pre></div>
<div class="output execute_result" data-execution_count="225">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drive-wheels</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fwd</th>
      <td>118</td>
    </tr>
    <tr>
      <th>rwd</th>
      <td>75</td>
    </tr>
    <tr>
      <th>4wd</th>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's repeat the above steps but save the results to the dataframe <code>drive_wheels_counts</code> and rename the column <code>drive-wheels</code> to <code>value_counts</code>.</strong></p>
<p><strong>A vehicle's drive wheel is the wheel and tire assembly that actually pushes or pulls the vehicle down the road.The four different types of drivetrain are all-wheel-drive (AWD), front wheel drive (FWD), rear wheel drive (RWD), and 4WD (4 wheel drive). (<a href="https://www.drivespark.com/off-beat/car-drivetrain-systems-explained-022723.html">more</a>)</strong></p>
</div>
<div class="cell code" data-execution_count="226">
<div class="sourceCode" id="cb80"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>drive_wheels_counts <span class="op">=</span> df[<span class="st">&#39;drive-wheels&#39;</span>].value_counts().to_frame()</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>drive_wheels_counts.rename(columns<span class="op">=</span>{<span class="st">&#39;drive-wheels&#39;</span>: <span class="st">&#39;value_counts&#39;</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>drive_wheels_counts.index.name <span class="op">=</span> <span class="st">&#39;drive-wheels&#39;</span> <span class="co"># Now let&#39;s rename the index to &#39;drive-wheels&#39;:</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>drive_wheels_counts</span></code></pre></div>
<div class="output execute_result" data-execution_count="226">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value_counts</th>
    </tr>
    <tr>
      <th>drive-wheels</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>fwd</th>
      <td>118</td>
    </tr>
    <tr>
      <th>rwd</th>
      <td>75</td>
    </tr>
    <tr>
      <th>4wd</th>
      <td>8</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>We can repeat the above process for the variable <code>engine-location</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="227">
<div class="sourceCode" id="cb81"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>engine_location_counts <span class="op">=</span> df[<span class="st">&#39;engine-location&#39;</span>].value_counts().to_frame()</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>engine_location_counts.rename(columns <span class="op">=</span> {<span class="st">&#39;engine-location&#39;</span> : <span class="st">&#39;value_counts&#39;</span>}, inplace <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>engine_location_counts.index.name <span class="op">=</span> <span class="st">&#39;engine-location&#39;</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>engine_location_counts</span></code></pre></div>
<div class="output execute_result" data-execution_count="227">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>value_counts</th>
    </tr>
    <tr>
      <th>engine-location</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>front</th>
      <td>198</td>
    </tr>
    <tr>
      <th>rear</th>
      <td>3</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>Examining the value counts of the <code>engine location</code> would <code>not be a good predictor</code> variable for the price. This is because we only have three cars with a rear engine and 198 with an engine in the front, this <code>result is skewed</code>. Thus, we are not able to draw any conclusions about the engine location.</strong></p>
</div>
<div class="cell markdown">
<h3><code>4.Basics of Grouping</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>The <code>groupby</code> method groups data by different categories. The data is grouped based on one or several variables and analysis is performed on the individual groups.</p>
    <p>For example, let's group by the variable <code>drive-wheels</code>. We see that there are 3 different categories of drive wheels.</p>
</div>
</div>
<div class="cell markdown">
<p><strong>For example, let's group by the variable <code>drive-wheels</code>. We see that there are 3 different categories of drive wheels.</strong></p>
</div>
<div class="cell code" data-execution_count="228">
<div class="sourceCode" id="cb82"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>df[<span class="st">&quot;drive-wheels&quot;</span>].unique()</span></code></pre></div>
<div class="output execute_result" data-execution_count="228">
<pre><code>array([&#39;rwd&#39;, &#39;fwd&#39;, &#39;4wd&#39;], dtype=object)</code></pre>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
<p>If we want to know, on average, which type of drive wheel is most valuable, we can group <code>drive-wheels</code> and then average them.</p>

<p>We can select the columns <code>drive-wheels</code>, <code>body-style</code> and <code>price</code>, then assign it to the variable <code>df_group_one</code>.</p>
    We can then calculate the average price for each of the different categories of data.
</div>
</div>
<div class="cell code" data-execution_count="229">
<div class="sourceCode" id="cb84"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>df_group_one <span class="op">=</span> df[[<span class="st">&#39;drive-wheels&#39;</span>, <span class="st">&#39;body-style&#39;</span>, <span class="st">&#39;price&#39;</span>]]</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>df_group_one <span class="op">=</span> df_group_one.groupby([<span class="st">&#39;drive-wheels&#39;</span>],as_index <span class="op">=</span> <span class="va">False</span>).mean() <span class="co"># if not passes as_index False it will make drive wheels as index</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>df_group_one</span></code></pre></div>
<div class="output execute_result" data-execution_count="229">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drive-wheels</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4wd</td>
      <td>10241.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>fwd</td>
      <td>9244.779661</td>
    </tr>
    <tr>
      <th>2</th>
      <td>rwd</td>
      <td>19757.613333</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
    <p>From our data, it seems rear-wheel drive vehicles are, on average, the most expensive, while 4-wheel and front-wheel are approximately the same in price.</p>

<p>You can also group with multiple variables. For example, let's group by both <code>drive-wheels</code> and <code>body-style</code>. This groups the dataframe by the unique combinations <code>drive-wheels</code> and <code>body-style</code>. We can store the results in the variable 'grouped_test1'.</p>
</div>
</div>
<div class="cell code" data-execution_count="230">
<div class="sourceCode" id="cb85"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># grouping results</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>df_gptest <span class="op">=</span> df[[<span class="st">&#39;drive-wheels&#39;</span>,<span class="st">&#39;body-style&#39;</span>,<span class="st">&#39;price&#39;</span>]]</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>grouped_test1 <span class="op">=</span> df_gptest.groupby([<span class="st">&#39;drive-wheels&#39;</span>,<span class="st">&#39;body-style&#39;</span>],as_index<span class="op">=</span><span class="va">False</span>).mean()</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>grouped_test1</span></code></pre></div>
<div class="output execute_result" data-execution_count="230">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drive-wheels</th>
      <th>body-style</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4wd</td>
      <td>hatchback</td>
      <td>7603.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>4wd</td>
      <td>sedan</td>
      <td>12647.333333</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4wd</td>
      <td>wagon</td>
      <td>9095.750000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fwd</td>
      <td>convertible</td>
      <td>11595.000000</td>
    </tr>
    <tr>
      <th>4</th>
      <td>fwd</td>
      <td>hardtop</td>
      <td>8249.000000</td>
    </tr>
    <tr>
      <th>5</th>
      <td>fwd</td>
      <td>hatchback</td>
      <td>8396.387755</td>
    </tr>
    <tr>
      <th>6</th>
      <td>fwd</td>
      <td>sedan</td>
      <td>9811.800000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>fwd</td>
      <td>wagon</td>
      <td>9997.333333</td>
    </tr>
    <tr>
      <th>8</th>
      <td>rwd</td>
      <td>convertible</td>
      <td>23949.600000</td>
    </tr>
    <tr>
      <th>9</th>
      <td>rwd</td>
      <td>hardtop</td>
      <td>24202.714286</td>
    </tr>
    <tr>
      <th>10</th>
      <td>rwd</td>
      <td>hatchback</td>
      <td>14337.777778</td>
    </tr>
    <tr>
      <th>11</th>
      <td>rwd</td>
      <td>sedan</td>
      <td>21711.833333</td>
    </tr>
    <tr>
      <th>12</th>
      <td>rwd</td>
      <td>wagon</td>
      <td>16994.222222</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><img src = "https://infovisual.info/storage/app/media/05/img_en/006%20Types%20of%20bodies.jpg"></p>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
    This grouped data is much easier to visualize when it is made into a pivot table. A pivot table is like an Excel spreadsheet, with one variable along the column and another along the row. We can convert the dataframe to a pivot table using the method "pivot " to create a pivot table from the groups.
<br>
    
In this case, we will leave the drive-wheel variable as the rows of the table, and pivot body-style to become the columns of the table:
</div>
</div>
<div class="cell code" data-execution_count="231">
<div class="sourceCode" id="cb86"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>grouped_pivot <span class="op">=</span> grouped_test1.pivot(index<span class="op">=</span><span class="st">&#39;drive-wheels&#39;</span>,columns<span class="op">=</span><span class="st">&#39;body-style&#39;</span>)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>grouped_pivot</span></code></pre></div>
<div class="output execute_result" data-execution_count="231">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">price</th>
    </tr>
    <tr>
      <th>body-style</th>
      <th>convertible</th>
      <th>hardtop</th>
      <th>hatchback</th>
      <th>sedan</th>
      <th>wagon</th>
    </tr>
    <tr>
      <th>drive-wheels</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4wd</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>7603.000000</td>
      <td>12647.333333</td>
      <td>9095.750000</td>
    </tr>
    <tr>
      <th>fwd</th>
      <td>11595.0</td>
      <td>8249.000000</td>
      <td>8396.387755</td>
      <td>9811.800000</td>
      <td>9997.333333</td>
    </tr>
    <tr>
      <th>rwd</th>
      <td>23949.6</td>
      <td>24202.714286</td>
      <td>14337.777778</td>
      <td>21711.833333</td>
      <td>16994.222222</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>Often, we won't have data for some of the pivot cells. We can fill these missing cells with the value 0, but any other value could potentially be used as well. It should be mentioned that missing data is quite a complex subject and is an entire course on its own. For simplicity, let's assign them 0</strong></p>
</div>
<div class="cell code" data-execution_count="232">
<div class="sourceCode" id="cb87"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>grouped_pivot <span class="op">=</span> grouped_pivot.fillna(<span class="dv">0</span>) <span class="co">#fill missing values with 0</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>grouped_pivot</span></code></pre></div>
<div class="output execute_result" data-execution_count="232">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th colspan="5" halign="left">price</th>
    </tr>
    <tr>
      <th>body-style</th>
      <th>convertible</th>
      <th>hardtop</th>
      <th>hatchback</th>
      <th>sedan</th>
      <th>wagon</th>
    </tr>
    <tr>
      <th>drive-wheels</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>4wd</th>
      <td>0.0</td>
      <td>0.000000</td>
      <td>7603.000000</td>
      <td>12647.333333</td>
      <td>9095.750000</td>
    </tr>
    <tr>
      <th>fwd</th>
      <td>11595.0</td>
      <td>8249.000000</td>
      <td>8396.387755</td>
      <td>9811.800000</td>
      <td>9997.333333</td>
    </tr>
    <tr>
      <th>rwd</th>
      <td>23949.6</td>
      <td>24202.714286</td>
      <td>14337.777778</td>
      <td>21711.833333</td>
      <td>16994.222222</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
    Use the <code>groupby</code> function to find the average <code>price</code> of each car based on <code>body-style</code> ?
</div>
</div>
<div class="cell code" data-execution_count="233">
<div class="sourceCode" id="cb88"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>df_gptest2 <span class="op">=</span> df[[<span class="st">&#39;body-style&#39;</span>,<span class="st">&#39;price&#39;</span>]]</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>grouped_test_bodystyle <span class="op">=</span> df_gptest2.groupby([<span class="st">&#39;body-style&#39;</span>],as_index<span class="op">=</span> <span class="va">False</span>).mean()</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>grouped_test_bodystyle</span></code></pre></div>
<div class="output execute_result" data-execution_count="233">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>body-style</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>convertible</td>
      <td>21890.500000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>hardtop</td>
      <td>22208.500000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>hatchback</td>
      <td>9957.441176</td>
    </tr>
    <tr>
      <th>3</th>
      <td>sedan</td>
      <td>14459.755319</td>
    </tr>
    <tr>
      <th>4</th>
      <td>wagon</td>
      <td>12371.960000</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<h4><code>Variables: Drive Wheels and Body Style vs Price</code></h4> 
</div>
<div class="alert alert-body alert-info" style="margin-top: 20px">
    Let's use a heat map to visualize the relationship between Body Style vs Price.
</div>
</div>
<div class="cell code" data-execution_count="234">
<div class="sourceCode" id="cb89"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>plt.pcolor(grouped_pivot, cmap <span class="op">=</span> <span class="st">&#39;RdBu&#39;</span>)</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>plt.colorbar() <span class="co"># show vertical range</span></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/be4f10b7113f25145b0741b54eb6f8c735ace9e0.png" /></p>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
The heatmap plots the target variable (price) proportional to colour with respect to the variables 'drive-wheel' and 'body-style' in the vertical and horizontal axis respectively. This allows us to visualize how the price is related to 'drive-wheel' and 'body-style'.

<code>The default labels convey no useful information to us. Let's change that:</code>
</div>
</div>
<div class="cell code" data-execution_count="235">
<div class="sourceCode" id="cb90"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>grouped_pivot.index</span></code></pre></div>
<div class="output execute_result" data-execution_count="235">
<pre><code>Index([&#39;4wd&#39;, &#39;fwd&#39;, &#39;rwd&#39;], dtype=&#39;object&#39;, name=&#39;drive-wheels&#39;)</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="236">
<div class="sourceCode" id="cb92"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a>im <span class="op">=</span> ax.pcolor(grouped_pivot, cmap<span class="op">=</span><span class="st">&#39;RdBu&#39;</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="co">#label names</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>row_labels <span class="op">=</span> grouped_pivot.columns.levels[<span class="dv">1</span>] <span class="co"># accesing &quot;body-type&quot; from grouped.pivot</span></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a>col_labels <span class="op">=</span> grouped_pivot.index <span class="co"># # accesing &quot;drive-wheels&quot; from grouped.pivot</span></span>
<span id="cb92-7"><a href="#cb92-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-8"><a href="#cb92-8" aria-hidden="true" tabindex="-1"></a><span class="co">#move ticks and labels to the center</span></span>
<span id="cb92-9"><a href="#cb92-9" aria-hidden="true" tabindex="-1"></a>ax.set_xticks(np.arange(grouped_pivot.shape[<span class="dv">1</span>]) <span class="op">+</span> <span class="fl">0.5</span>, minor<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-10"><a href="#cb92-10" aria-hidden="true" tabindex="-1"></a>ax.set_yticks(np.arange(grouped_pivot.shape[<span class="dv">0</span>]) <span class="op">+</span> <span class="fl">0.5</span>, minor<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-11"><a href="#cb92-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-12"><a href="#cb92-12" aria-hidden="true" tabindex="-1"></a><span class="co">#insert labels</span></span>
<span id="cb92-13"><a href="#cb92-13" aria-hidden="true" tabindex="-1"></a>ax.set_xticklabels(row_labels, minor<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-14"><a href="#cb92-14" aria-hidden="true" tabindex="-1"></a>ax.set_yticklabels(col_labels, minor<span class="op">=</span><span class="va">False</span>)</span>
<span id="cb92-15"><a href="#cb92-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-16"><a href="#cb92-16" aria-hidden="true" tabindex="-1"></a><span class="co">#rotate label if too long</span></span>
<span id="cb92-17"><a href="#cb92-17" aria-hidden="true" tabindex="-1"></a>plt.xticks(rotation<span class="op">=</span><span class="dv">90</span>)</span>
<span id="cb92-18"><a href="#cb92-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-19"><a href="#cb92-19" aria-hidden="true" tabindex="-1"></a>fig.colorbar(im)</span>
<span id="cb92-20"><a href="#cb92-20" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/c1bbe69ad16ded8af32b42d4b2726a4ae7c7ae00.png" /></p>
</div>
</div>
<section id="5-correlation-and-causation" class="cell markdown">
<h3><code>5. Correlation and Causation</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p><b>Correlation</b>: a measure of the extent of interdependence between variables.</p>

<p><b>Causation</b>: the relationship between cause and effect between two variables.</p>

<p>It is important to know the difference between these two and that correlation does not imply causation. Determining correlation is much simpler  the determining causation as causation may require independent experimentation.</p>

<p3>Pearson Correlation</p>

<p>The Pearson Correlation measures the linear dependence between two variables X and Y.</p>
<p>The resulting coefficient is a value between -1 and 1 inclusive, where:</p>
<ul>
    <li><b>1</b>: Total positive linear correlation.</li>
    <li><b>0</b>: No linear correlation, the two variables most likely do not affect each other.</li>
    <li><b>-1</b>: Total negative linear correlation.</li>
</ul></div>
</section>
<div class="cell code" data-execution_count="237">
<div class="sourceCode" id="cb93"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>df.corr()</span></code></pre></div>
<div class="output execute_result" data-execution_count="237">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>symboling</th>
      <th>normalized-losses</th>
      <th>wheel-base</th>
      <th>length</th>
      <th>width</th>
      <th>height</th>
      <th>curb-weight</th>
      <th>engine-size</th>
      <th>bore</th>
      <th>stroke</th>
      <th>...</th>
      <th>peak-rpm</th>
      <th>city-mpg</th>
      <th>highway-mpg</th>
      <th>price</th>
      <th>city-L/100km</th>
      <th>highway-L/100km</th>
      <th>fuel-type-diesel</th>
      <th>fuel-type-gas</th>
      <th>aspiration-std</th>
      <th>aspiration-turbo</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>symboling</th>
      <td>1.000000</td>
      <td>0.466264</td>
      <td>-0.535987</td>
      <td>-0.365404</td>
      <td>-0.242423</td>
      <td>-0.550160</td>
      <td>-0.233118</td>
      <td>-0.110581</td>
      <td>-0.140019</td>
      <td>-0.008153</td>
      <td>...</td>
      <td>0.279740</td>
      <td>-0.035527</td>
      <td>0.036233</td>
      <td>-0.082391</td>
      <td>0.066171</td>
      <td>-0.029807</td>
      <td>-0.196735</td>
      <td>0.196735</td>
      <td>0.054615</td>
      <td>-0.054615</td>
    </tr>
    <tr>
      <th>normalized-losses</th>
      <td>0.466264</td>
      <td>1.000000</td>
      <td>-0.056661</td>
      <td>0.019424</td>
      <td>0.086802</td>
      <td>-0.373737</td>
      <td>0.099404</td>
      <td>0.112360</td>
      <td>-0.029862</td>
      <td>0.055045</td>
      <td>...</td>
      <td>0.239543</td>
      <td>-0.225016</td>
      <td>-0.181877</td>
      <td>0.133999</td>
      <td>0.238567</td>
      <td>0.181189</td>
      <td>-0.101546</td>
      <td>0.101546</td>
      <td>0.006911</td>
      <td>-0.006911</td>
    </tr>
    <tr>
      <th>wheel-base</th>
      <td>-0.535987</td>
      <td>-0.056661</td>
      <td>1.000000</td>
      <td>0.876024</td>
      <td>0.814507</td>
      <td>0.590742</td>
      <td>0.782097</td>
      <td>0.572027</td>
      <td>0.493244</td>
      <td>0.158018</td>
      <td>...</td>
      <td>-0.360305</td>
      <td>-0.470606</td>
      <td>-0.543304</td>
      <td>0.584642</td>
      <td>0.476153</td>
      <td>0.577576</td>
      <td>0.307237</td>
      <td>-0.307237</td>
      <td>-0.256889</td>
      <td>0.256889</td>
    </tr>
    <tr>
      <th>length</th>
      <td>-0.365404</td>
      <td>0.019424</td>
      <td>0.876024</td>
      <td>1.000000</td>
      <td>0.857170</td>
      <td>0.492063</td>
      <td>0.880665</td>
      <td>0.685025</td>
      <td>0.608971</td>
      <td>0.123952</td>
      <td>...</td>
      <td>-0.285970</td>
      <td>-0.665192</td>
      <td>-0.698142</td>
      <td>0.690628</td>
      <td>0.657373</td>
      <td>0.707108</td>
      <td>0.211187</td>
      <td>-0.211187</td>
      <td>-0.230085</td>
      <td>0.230085</td>
    </tr>
    <tr>
      <th>width</th>
      <td>-0.242423</td>
      <td>0.086802</td>
      <td>0.814507</td>
      <td>0.857170</td>
      <td>1.000000</td>
      <td>0.306002</td>
      <td>0.866201</td>
      <td>0.729436</td>
      <td>0.544885</td>
      <td>0.188822</td>
      <td>...</td>
      <td>-0.245800</td>
      <td>-0.633531</td>
      <td>-0.680635</td>
      <td>0.751265</td>
      <td>0.673363</td>
      <td>0.736728</td>
      <td>0.244356</td>
      <td>-0.244356</td>
      <td>-0.305732</td>
      <td>0.305732</td>
    </tr>
    <tr>
      <th>height</th>
      <td>-0.550160</td>
      <td>-0.373737</td>
      <td>0.590742</td>
      <td>0.492063</td>
      <td>0.306002</td>
      <td>1.000000</td>
      <td>0.307581</td>
      <td>0.074694</td>
      <td>0.180449</td>
      <td>-0.060663</td>
      <td>...</td>
      <td>-0.309974</td>
      <td>-0.049800</td>
      <td>-0.104812</td>
      <td>0.135486</td>
      <td>0.003811</td>
      <td>0.084301</td>
      <td>0.281578</td>
      <td>-0.281578</td>
      <td>-0.090336</td>
      <td>0.090336</td>
    </tr>
    <tr>
      <th>curb-weight</th>
      <td>-0.233118</td>
      <td>0.099404</td>
      <td>0.782097</td>
      <td>0.880665</td>
      <td>0.866201</td>
      <td>0.307581</td>
      <td>1.000000</td>
      <td>0.849072</td>
      <td>0.644060</td>
      <td>0.167438</td>
      <td>...</td>
      <td>-0.279361</td>
      <td>-0.749543</td>
      <td>-0.794889</td>
      <td>0.834415</td>
      <td>0.785353</td>
      <td>0.836921</td>
      <td>0.221046</td>
      <td>-0.221046</td>
      <td>-0.321955</td>
      <td>0.321955</td>
    </tr>
    <tr>
      <th>engine-size</th>
      <td>-0.110581</td>
      <td>0.112360</td>
      <td>0.572027</td>
      <td>0.685025</td>
      <td>0.729436</td>
      <td>0.074694</td>
      <td>0.849072</td>
      <td>1.000000</td>
      <td>0.572609</td>
      <td>0.205928</td>
      <td>...</td>
      <td>-0.256733</td>
      <td>-0.650546</td>
      <td>-0.679571</td>
      <td>0.872335</td>
      <td>0.745059</td>
      <td>0.783465</td>
      <td>0.070779</td>
      <td>-0.070779</td>
      <td>-0.110040</td>
      <td>0.110040</td>
    </tr>
    <tr>
      <th>bore</th>
      <td>-0.140019</td>
      <td>-0.029862</td>
      <td>0.493244</td>
      <td>0.608971</td>
      <td>0.544885</td>
      <td>0.180449</td>
      <td>0.644060</td>
      <td>0.572609</td>
      <td>1.000000</td>
      <td>-0.055390</td>
      <td>...</td>
      <td>-0.267392</td>
      <td>-0.582027</td>
      <td>-0.591309</td>
      <td>0.543155</td>
      <td>0.554610</td>
      <td>0.559112</td>
      <td>0.054458</td>
      <td>-0.054458</td>
      <td>-0.227816</td>
      <td>0.227816</td>
    </tr>
    <tr>
      <th>stroke</th>
      <td>-0.008153</td>
      <td>0.055045</td>
      <td>0.158018</td>
      <td>0.123952</td>
      <td>0.188822</td>
      <td>-0.060663</td>
      <td>0.167438</td>
      <td>0.205928</td>
      <td>-0.055390</td>
      <td>1.000000</td>
      <td>...</td>
      <td>-0.063561</td>
      <td>-0.033956</td>
      <td>-0.034636</td>
      <td>0.082269</td>
      <td>0.036133</td>
      <td>0.047089</td>
      <td>0.241064</td>
      <td>-0.241064</td>
      <td>-0.218233</td>
      <td>0.218233</td>
    </tr>
    <tr>
      <th>compression-ratio</th>
      <td>-0.182196</td>
      <td>-0.114713</td>
      <td>0.250313</td>
      <td>0.159733</td>
      <td>0.189867</td>
      <td>0.259737</td>
      <td>0.156433</td>
      <td>0.028889</td>
      <td>0.001263</td>
      <td>0.187871</td>
      <td>...</td>
      <td>-0.435780</td>
      <td>0.331425</td>
      <td>0.268465</td>
      <td>0.071107</td>
      <td>-0.299372</td>
      <td>-0.223361</td>
      <td>0.985231</td>
      <td>-0.985231</td>
      <td>-0.307522</td>
      <td>0.307522</td>
    </tr>
    <tr>
      <th>horsepower</th>
      <td>0.075810</td>
      <td>0.217300</td>
      <td>0.371178</td>
      <td>0.579795</td>
      <td>0.615056</td>
      <td>-0.087001</td>
      <td>0.757981</td>
      <td>0.822668</td>
      <td>0.566903</td>
      <td>0.098128</td>
      <td>...</td>
      <td>0.107884</td>
      <td>-0.822192</td>
      <td>-0.804579</td>
      <td>0.809607</td>
      <td>0.889482</td>
      <td>0.840627</td>
      <td>-0.169030</td>
      <td>0.169030</td>
      <td>-0.251159</td>
      <td>0.251159</td>
    </tr>
    <tr>
      <th>peak-rpm</th>
      <td>0.279740</td>
      <td>0.239543</td>
      <td>-0.360305</td>
      <td>-0.285970</td>
      <td>-0.245800</td>
      <td>-0.309974</td>
      <td>-0.279361</td>
      <td>-0.256733</td>
      <td>-0.267392</td>
      <td>-0.063561</td>
      <td>...</td>
      <td>1.000000</td>
      <td>-0.115413</td>
      <td>-0.058598</td>
      <td>-0.101616</td>
      <td>0.115830</td>
      <td>0.017694</td>
      <td>-0.475812</td>
      <td>0.475812</td>
      <td>0.190057</td>
      <td>-0.190057</td>
    </tr>
    <tr>
      <th>city-mpg</th>
      <td>-0.035527</td>
      <td>-0.225016</td>
      <td>-0.470606</td>
      <td>-0.665192</td>
      <td>-0.633531</td>
      <td>-0.049800</td>
      <td>-0.749543</td>
      <td>-0.650546</td>
      <td>-0.582027</td>
      <td>-0.033956</td>
      <td>...</td>
      <td>-0.115413</td>
      <td>1.000000</td>
      <td>0.972044</td>
      <td>-0.686571</td>
      <td>-0.949713</td>
      <td>-0.909024</td>
      <td>0.265676</td>
      <td>-0.265676</td>
      <td>0.189237</td>
      <td>-0.189237</td>
    </tr>
    <tr>
      <th>highway-mpg</th>
      <td>0.036233</td>
      <td>-0.181877</td>
      <td>-0.543304</td>
      <td>-0.698142</td>
      <td>-0.680635</td>
      <td>-0.104812</td>
      <td>-0.794889</td>
      <td>-0.679571</td>
      <td>-0.591309</td>
      <td>-0.034636</td>
      <td>...</td>
      <td>-0.058598</td>
      <td>0.972044</td>
      <td>1.000000</td>
      <td>-0.704692</td>
      <td>-0.930028</td>
      <td>-0.951100</td>
      <td>0.198690</td>
      <td>-0.198690</td>
      <td>0.241851</td>
      <td>-0.241851</td>
    </tr>
    <tr>
      <th>price</th>
      <td>-0.082391</td>
      <td>0.133999</td>
      <td>0.584642</td>
      <td>0.690628</td>
      <td>0.751265</td>
      <td>0.135486</td>
      <td>0.834415</td>
      <td>0.872335</td>
      <td>0.543155</td>
      <td>0.082269</td>
      <td>...</td>
      <td>-0.101616</td>
      <td>-0.686571</td>
      <td>-0.704692</td>
      <td>1.000000</td>
      <td>0.789898</td>
      <td>0.801118</td>
      <td>0.110326</td>
      <td>-0.110326</td>
      <td>-0.179578</td>
      <td>0.179578</td>
    </tr>
    <tr>
      <th>city-L/100km</th>
      <td>0.066171</td>
      <td>0.238567</td>
      <td>0.476153</td>
      <td>0.657373</td>
      <td>0.673363</td>
      <td>0.003811</td>
      <td>0.785353</td>
      <td>0.745059</td>
      <td>0.554610</td>
      <td>0.036133</td>
      <td>...</td>
      <td>0.115830</td>
      <td>-0.949713</td>
      <td>-0.930028</td>
      <td>0.789898</td>
      <td>1.000000</td>
      <td>0.958306</td>
      <td>-0.241282</td>
      <td>0.241282</td>
      <td>-0.157578</td>
      <td>0.157578</td>
    </tr>
    <tr>
      <th>highway-L/100km</th>
      <td>-0.029807</td>
      <td>0.181189</td>
      <td>0.577576</td>
      <td>0.707108</td>
      <td>0.736728</td>
      <td>0.084301</td>
      <td>0.836921</td>
      <td>0.783465</td>
      <td>0.559112</td>
      <td>0.047089</td>
      <td>...</td>
      <td>0.017694</td>
      <td>-0.909024</td>
      <td>-0.951100</td>
      <td>0.801118</td>
      <td>0.958306</td>
      <td>1.000000</td>
      <td>-0.158091</td>
      <td>0.158091</td>
      <td>-0.210720</td>
      <td>0.210720</td>
    </tr>
    <tr>
      <th>fuel-type-diesel</th>
      <td>-0.196735</td>
      <td>-0.101546</td>
      <td>0.307237</td>
      <td>0.211187</td>
      <td>0.244356</td>
      <td>0.281578</td>
      <td>0.221046</td>
      <td>0.070779</td>
      <td>0.054458</td>
      <td>0.241064</td>
      <td>...</td>
      <td>-0.475812</td>
      <td>0.265676</td>
      <td>0.198690</td>
      <td>0.110326</td>
      <td>-0.241282</td>
      <td>-0.158091</td>
      <td>1.000000</td>
      <td>-1.000000</td>
      <td>-0.408228</td>
      <td>0.408228</td>
    </tr>
    <tr>
      <th>fuel-type-gas</th>
      <td>0.196735</td>
      <td>0.101546</td>
      <td>-0.307237</td>
      <td>-0.211187</td>
      <td>-0.244356</td>
      <td>-0.281578</td>
      <td>-0.221046</td>
      <td>-0.070779</td>
      <td>-0.054458</td>
      <td>-0.241064</td>
      <td>...</td>
      <td>0.475812</td>
      <td>-0.265676</td>
      <td>-0.198690</td>
      <td>-0.110326</td>
      <td>0.241282</td>
      <td>0.158091</td>
      <td>-1.000000</td>
      <td>1.000000</td>
      <td>0.408228</td>
      <td>-0.408228</td>
    </tr>
    <tr>
      <th>aspiration-std</th>
      <td>0.054615</td>
      <td>0.006911</td>
      <td>-0.256889</td>
      <td>-0.230085</td>
      <td>-0.305732</td>
      <td>-0.090336</td>
      <td>-0.321955</td>
      <td>-0.110040</td>
      <td>-0.227816</td>
      <td>-0.218233</td>
      <td>...</td>
      <td>0.190057</td>
      <td>0.189237</td>
      <td>0.241851</td>
      <td>-0.179578</td>
      <td>-0.157578</td>
      <td>-0.210720</td>
      <td>-0.408228</td>
      <td>0.408228</td>
      <td>1.000000</td>
      <td>-1.000000</td>
    </tr>
    <tr>
      <th>aspiration-turbo</th>
      <td>-0.054615</td>
      <td>-0.006911</td>
      <td>0.256889</td>
      <td>0.230085</td>
      <td>0.305732</td>
      <td>0.090336</td>
      <td>0.321955</td>
      <td>0.110040</td>
      <td>0.227816</td>
      <td>0.218233</td>
      <td>...</td>
      <td>-0.190057</td>
      <td>-0.189237</td>
      <td>-0.241851</td>
      <td>0.179578</td>
      <td>0.157578</td>
      <td>0.210720</td>
      <td>0.408228</td>
      <td>-0.408228</td>
      <td>-1.000000</td>
      <td>1.000000</td>
    </tr>
  </tbody>
</table>
<p>22 rows × 22 columns</p>
</div>
</div>
</div>
<div class="cell markdown">
<div class="alert alert-body alert-info" style="margin-top: 20px">
    sometimes we would like to know the significant of the correlation estimate.<br>
    <b>P-value: 

<p>What is this P-value? The P-value is the probability value that the correlation between these two variables is statistically significant. Normally, we choose a significance level of 0.05, which means that we are 95% confident that the correlation between the variables is significant.</p>

By convention, when the

<ul>
    <li>p-value is $<$ 0.001: we say there is strong evidence that the correlation is significant.</li>
    <li>the p-value is $<$ 0.05: there is moderate evidence that the correlation is significant.</li>
    <li>the p-value is $<$ 0.1: there is weak evidence that the correlation is significant.</li>
    <li>the p-value is $>$ 0.1: there is no evidence that the correlation is significant.</li>
</ul>

</b>
</div>
<p><strong>We can obtain this information using <code>stats</code> module in the <code>scipy</code> library.</strong></p>
</div>
<section id="wheel-base-vs-price" class="cell markdown">
<h4><code>Wheel-base vs Price</code></h4>
<p>Let's calculate the Pearson Correlation Coefficient and P-value of <code>wheel-base</code> and <code>price</code>.</p>
</section>
<div class="cell code" data-execution_count="238">
<div class="sourceCode" id="cb94"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;wheel-base&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P =&quot;</span>, p_value)  </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.584641822265508  with a P-value of P = 8.076488270733218e-20
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between wheel-base and price is statistically significant, although the linear relationship isn't extremely strong (~0.585)</strong></p>
<h4 id="horsepower-vs-price"><code>Horsepower vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>horsepower</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="239">
<div class="sourceCode" id="cb96"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;horsepower&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P = &quot;</span>, p_value)  </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.8096068016571054  with a P-value of P =  6.273536270650504e-48
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between horsepower and price is statistically significant, and the linear relationship is quite strong (~0.809, close to 1)</strong></p>
<h4 id="length-vs-price"><code>Length vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>length</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="240">
<div class="sourceCode" id="cb98"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;length&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P = &quot;</span>, p_value)  </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.6906283804483639  with a P-value of P =  8.016477466159328e-30
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between length and price is statistically significant, and the linear relationship is moderately strong (~0.691).</strong></p>
<h4 id="width-vs-price"><code>Width vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>width</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="241">
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;width&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P =&quot;</span>, p_value ) </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.7512653440522672  with a P-value of P = 9.20033551048217e-38
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between width and price is statistically significant, and the linear relationship is quite strong (~0.751).</strong></p>
<h4 id="curb-weight-vs-price"><code>Curb-weight vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>curb-weight</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="242">
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;curb-weight&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P = &quot;</span>, p_value)  </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.8344145257702843  with a P-value of P =  2.189577238894065e-53
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between curb-weight and price is statistically significant, and the linear relationship is quite strong (~0.834)</strong></p>
<h4 id="engine-size-vs-price"><code>Engine-size vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>engine-size</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="243">
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;engine-size&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P =&quot;</span>, p_value) </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.8723351674455182  with a P-value of P = 9.265491622200232e-64
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between engine-size and price is statistically significant, and the linear relationship is very strong (~0.872).</strong></p>
<h4 id="bore-vs-price"><code>Bore vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>bore</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="244">
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;bore&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P =  &quot;</span>, p_value ) </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is 0.5431553832626603  with a P-value of P =   8.049189483935261e-17
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between bore and price is statistically significant, but the linear relationship is only moderate (~0.521).</strong></p>
<h4 id="city-mpg-vs-price"><code>City-mpg vs Price</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>city-mpg</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="245">
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;city-mpg&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P = &quot;</span>, p_value)  </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is -0.6865710067844678  with a P-value of P =  2.321132065567641e-29
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between city-mpg and price is statistically significant, and the coefficient of ~ -0.687 shows that the relationship is negative and moderately strong.</strong></p>
<h4 id="highway-mpg-vs-price"><code>Highway-mpg vs Price¶</code></h4>
<p><strong>Let's calculate the Pearson Correlation Coefficient and P-value of <code>highway-mpg</code> and <code>price</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="246">
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>pearson_coef, p_value <span class="op">=</span> stats.pearsonr(df[<span class="st">&#39;highway-mpg&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">&quot;The Pearson Correlation Coefficient is&quot;</span>, pearson_coef, <span class="st">&quot; with a P-value of P = &quot;</span>, p_value ) </span></code></pre></div>
<div class="output stream stdout">
<pre><code>The Pearson Correlation Coefficient is -0.704692265058953  with a P-value of P =  1.7495471144476358e-31
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Conclusion:</code></strong></p>
<p><strong>Since the p-value is &lt; 0.001, the correlation between highway-mpg and price is statistically significant, and the coefficient of ~ -0.705 shows that the relationship is negative and moderately strong.</strong></p>
<h3 id="6-anova"><code>6. ANOVA</code></h3>
<div class="alert alert-danger alertdanger" style="margin-top: 20px">
<p>The Analysis of Variance  (ANOVA) is a statistical method used to test whether there are significant differences between the means of two or more groups. ANOVA returns two parameters:</p>

<p><b>F-test score</b>: ANOVA assumes the means of all groups are the same, calculates how much the actual means deviate from the assumption, and reports it as the F-test score. A larger score means there is a larger difference between the means.</p>

<p><b>P-value</b>:  P-value tells how statistically significant is our calculated score value.</p>

<p>If our price variable is strongly correlated with the variable we are analyzing, expect ANOVA to return a sizeable F-test score and a small p-value.</p>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Drive Wheels</code></strong></p>
<p><strong>Since ANOVA analyzes the difference between different groups of the same variable, the groupby function will come in handy. Because the ANOVA algorithm averages the data automatically, we do not need to take the average before hand.</strong></p>
<p><strong>Let's see if different types <code>drive-wheels</code> impact <code>price</code>, we group the data.</strong></p>
</div>
<div class="cell code" data-execution_count="247">
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>grouped_test2<span class="op">=</span>df_gptest[[<span class="st">&#39;drive-wheels&#39;</span>, <span class="st">&#39;price&#39;</span>]].groupby([<span class="st">&#39;drive-wheels&#39;</span>])</span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>grouped_test2.head(<span class="dv">2</span>)</span></code></pre></div>
<div class="output execute_result" data-execution_count="247">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>drive-wheels</th>
      <th>price</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>rwd</td>
      <td>13495.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>rwd</td>
      <td>16500.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>fwd</td>
      <td>13950.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4wd</td>
      <td>17450.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>fwd</td>
      <td>15250.0</td>
    </tr>
    <tr>
      <th>136</th>
      <td>4wd</td>
      <td>7603.0</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell markdown">
<p><strong>We can obtain the values of the method group using the method <code>get_group</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="248">
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>grouped_test2.get_group(<span class="st">&#39;4wd&#39;</span>)[<span class="st">&#39;price&#39;</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="248">
<pre><code>4      17450.0
136     7603.0
140     9233.0
141    11259.0
144     8013.0
145    11694.0
150     7898.0
151     8778.0
Name: price, dtype: float64</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>we can use the function <code>f_oneway</code> in the module <code>stats</code> to obtain the F-test score and P-value.</strong></p>
</div>
<div class="cell code" data-execution_count="249">
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ANOVA</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>f_val, p_val <span class="op">=</span> stats.f_oneway(grouped_test2.get_group(<span class="st">&#39;fwd&#39;</span>)[<span class="st">&#39;price&#39;</span>], grouped_test2.get_group(<span class="st">&#39;rwd&#39;</span>)[<span class="st">&#39;price&#39;</span>], grouped_test2.get_group(<span class="st">&#39;4wd&#39;</span>)[<span class="st">&#39;price&#39;</span>])  </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">&quot;ANOVA results: F=&quot;</span>, f_val, <span class="st">&quot;, P =&quot;</span>, p_val)   </span></code></pre></div>
<div class="output stream stdout">
<pre><code>ANOVA results: F= 67.95406500780399 , P = 3.3945443577151245e-23
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>This is a great result, with a large F test score showing a strong correlation and a P value of almost 0 implying almost certain statistical significance. But does this mean all three tested groups are all this highly correlated?</strong></p>
<p><strong><code>Separately:</code></strong></p>
</div>
<div class="cell code" data-execution_count="250">
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>f_val, p_val <span class="op">=</span> stats.f_oneway(grouped_test2.get_group(<span class="st">&#39;fwd&#39;</span>)[<span class="st">&#39;price&#39;</span>], grouped_test2.get_group(<span class="st">&#39;rwd&#39;</span>)[<span class="st">&#39;price&#39;</span>])  </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">&quot;fwd and rwd -&gt; ANOVA results: F=&quot;</span>, f_val, <span class="st">&quot;, P =&quot;</span>, p_val )</span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-4"><a href="#cb117-4" aria-hidden="true" tabindex="-1"></a>f_val, p_val <span class="op">=</span> stats.f_oneway(grouped_test2.get_group(<span class="st">&#39;4wd&#39;</span>)[<span class="st">&#39;price&#39;</span>], grouped_test2.get_group(<span class="st">&#39;rwd&#39;</span>)[<span class="st">&#39;price&#39;</span>])     </span>
<span id="cb117-5"><a href="#cb117-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>( <span class="st">&quot;4wd and rwd -&gt; ANOVA results: F=&quot;</span>, f_val, <span class="st">&quot;, P =&quot;</span>, p_val) </span>
<span id="cb117-6"><a href="#cb117-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-7"><a href="#cb117-7" aria-hidden="true" tabindex="-1"></a>f_val, p_val <span class="op">=</span> stats.f_oneway(grouped_test2.get_group(<span class="st">&#39;4wd&#39;</span>)[<span class="st">&#39;price&#39;</span>], grouped_test2.get_group(<span class="st">&#39;fwd&#39;</span>)[<span class="st">&#39;price&#39;</span>])  </span>
<span id="cb117-8"><a href="#cb117-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;4wd and fwd -&gt; ANOVA results: F=&quot;</span>, f_val, <span class="st">&quot;, P =&quot;</span>, p_val)   </span></code></pre></div>
<div class="output stream stdout">
<pre><code>fwd and rwd -&gt; ANOVA results: F= 130.5533160959111 , P = 2.2355306355677845e-23
4wd and rwd -&gt; ANOVA results: F= 8.580681368924756 , P = 0.004411492211225333
4wd and fwd -&gt; ANOVA results: F= 0.665465750252303 , P = 0.41620116697845666
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Conclusion: <code>Important Variables</code></strong> <b> <p>We now have a better idea of what our data looks like and which variables are important to take into account when predicting the car price. We have narrowed it down to the following variables:</p></p>
<p>Continuous numerical variables:</p>
<ul>
    <li>Length</li>
    <li>Width</li>
    <li>Curb-weight</li>
    <li>Engine-size</li>
    <li>Horsepower</li>
    <li>City-mpg</li>
    <li>Highway-mpg</li>
    <li>Wheel-base</li>
    <li>Bore</li>
</ul>
<p>Categorical variables: <ul> <li>Drive-wheels</li> </ul></p>
<p>As we now move into building machine learning models to automate our analysis, feeding the model with variables that meaningfully affect our target variable will improve our model's prediction performance.</p>
<p></b></p>
<hr />
</div>
<section id="7-model-development" class="cell markdown">
<h2><code>7. Model Development</code></h2>
<p><strong><code>Objectives</code></strong></p>
<p><strong>Develop prediction models</strong></p>
<p><strong>In this section, we will develop several models that will predict the price of the car using the variables or features. This is just an estimate but should give us an objective idea of how much the car should cost.</strong></p>
<p><strong>Some questions we want to ask in this module</strong></p>
<ul>
<li><strong>do I know if the dealer is offering fair value for my trade-in?</strong></li>
<li><strong>do I know if I put a fair value on my car?</strong></li>
<li><strong>Data Analytics, we often use Model Development to help us predict future observations from the data we have.</strong></li>
</ul>
<p><strong>A Model will help us understand the exact relationship between different variables and how these variables are used to predict the result.</strong></p>
</section>
<section id="1-linear-regression-and-multiple-linear-regression" class="cell markdown">
<h3><code>1: Linear Regression and Multiple Linear Regression</code></h3>
<h4><code>Linear Regression</code></h4>
<p>One example of a Data  Model that we will be using is</p>
<p><b>Simple Linear Regression</b>.</p>
<p><br> <p>Simple Linear Regression is a method to help us understand the relationship between two variables:</p> <ul> <li>The predictor/independent variable (X)</li> <li>The response/dependent variable (that we want to predict)(Y)</li> </ul></p>
<p>The result of Linear Regression is a <b>linear function</b> that predicts the response (dependent) variable as a function of the predictor (independent) variable.</p>
<p><span class="math display">$$
 Y: Response \ Variable\\
 X: Predictor \ Variables
$$</span></p>
<p><b>Linear function:</b> <span class="math display"><em>Y</em><em>h</em><em>a</em><em>t</em> = <em>a</em> + <em>b</em><em>X</em></span></p>
<ul>
    <li>a refers to the <b>intercept</b> of the regression line0, in other words: the value of Y when X is 0</li>
    <li>b refers to the <b>slope</b> of the regression line, in other words: the value with which Y changes when X increases by 1 unit</li>
</ul>
</section>
<div class="cell markdown">
<p><strong>Create the linear regression object</strong></p>
</div>
<div class="cell code" data-execution_count="251">
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>lm <span class="op">=</span> LinearRegression()</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong><code>How could Highway-mpg help us predict car price?</code></strong></p>
<p><strong>we will create a linear function with "highway-mpg" as the predictor variable and the "price" as the response variable.</strong></p>
</div>
<div class="cell code" data-execution_count="252">
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="st">&#39;highway-mpg&#39;</span>]]</span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> df[<span class="st">&#39;price&#39;</span>]</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>Fit the linear model using highway-mpg.</strong></p>
</div>
<div class="cell code" data-execution_count="253">
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>lm.fit(X,Y)</span></code></pre></div>
<div class="output execute_result" data-execution_count="253">
<style>#sk-container-id-11 {color: black;background-color: white;}#sk-container-id-11 pre{padding: 0;}#sk-container-id-11 div.sk-toggleable {background-color: white;}#sk-container-id-11 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-11 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-11 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-11 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-11 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-11 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-11 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-11 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-11 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-11 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-11 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-11 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-11 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-11 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-11 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-11 div.sk-item {position: relative;z-index: 1;}#sk-container-id-11 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-11 div.sk-item::before, #sk-container-id-11 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-11 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-11 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-11 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-11 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-11 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-11 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-11 div.sk-label-container {text-align: center;}#sk-container-id-11 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-11 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-11" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-19" type="checkbox" checked><label for="sk-estimator-id-19" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>We can output a prediction</strong></p>
</div>
<div class="cell code" data-execution_count="254">
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>Yhat<span class="op">=</span>lm.predict(X)</span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>Yhat[<span class="dv">0</span>:<span class="dv">5</span>]   </span></code></pre></div>
<div class="output execute_result" data-execution_count="254">
<pre><code>array([16236.50464347, 16236.50464347, 17058.23802179, 13771.3045085 ,
       20345.17153508])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>What is the value of the intercept (a)?</strong></p>
</div>
<div class="cell code" data-execution_count="255">
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>lm.intercept_</span></code></pre></div>
<div class="output execute_result" data-execution_count="255">
<pre><code>38423.3058581574</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>What is the value of the Slope (b)?</strong></p>
</div>
<div class="cell code" data-execution_count="256">
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>lm.coef_</span></code></pre></div>
<div class="output execute_result" data-execution_count="256">
<pre><code>array([-821.73337832])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>What is the final estimated linear model we get?</code></strong></p>
<p><strong>As we saw above, we should get a final linear model with the structure:</strong></p>
<p><span class="math display"><em>Y</em><em>h</em><em>a</em><em>t</em> = <em>a</em> + <em>b</em><em>X</em></span></p>
<p><strong>with actual values we get:</strong> <strong><code>price = 38423.31 - 821.73 * highway-mpg</code></strong></p>
</div>
<div class="cell markdown">
<p><strong><code>Train the model using 'engine-size' as the independent variable and 'price' as the dependent variable</code></strong></p>
</div>
<div class="cell code" data-execution_count="257">
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extracting independent variable target variables</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>lm1 <span class="op">=</span> LinearRegression()</span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a><span class="co"># fit in linear model</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>lm1.fit( df[[<span class="st">&#39;engine-size&#39;</span>]], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb128-6"><a href="#cb128-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-7"><a href="#cb128-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What is the value of the intercept (a)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm1.intercept_))</span>
<span id="cb128-8"><a href="#cb128-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What is the value of the Slope (b)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm1.coef_))</span>
<span id="cb128-9"><a href="#cb128-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Final estimated linear model&quot;</span>)</span>
<span id="cb128-10"><a href="#cb128-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Yhat=-7963.34 + 166.86*X&quot;</span>)</span>
<span id="cb128-11"><a href="#cb128-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Price=-7963.34 + 166.86*engine-size&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>What is the value of the intercept (a)? 
 -7963.338906281024
What is the value of the Slope (b)? 
 [166.86001569]

 Final estimated linear model
Yhat=-7963.34 + 166.86*X
Price=-7963.34 + 166.86*engine-size
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Multiple Linear Regression</code></strong></p>
<p>What if we want to predict car price using more than one variable?</p>
<p>If we want to use more variables in our model to predict car price, we can use <b>Multiple Linear Regression</b>.
Multiple Linear Regression is very similar to Simple Linear Regression, but this method is used to explain the relationship between one continuous response (dependent) variable and <b>two or more</b> predictor (independent) variables.
Most of the real-world regression models involve multiple predictors. We will illustrate the structure by using four predictor variables, but these results can generalize to any integer:</p>
<p><span class="math display">$$
Y: Response \ Variable\\
X_1 :Predictor \ Variable \ 1\\
X_2: Predictor\ Variable \ 2\\
X_3: Predictor\ Variable \ 3\\
X_4: Predictor\ Variable \ 4\\
$$</span></p>
<p><span class="math display">$$
a: intercept\\
b_1 :coefficients \ of\ Variable \ 1\\
b_2: coefficients \ of\ Variable \ 2\\
b_3: coefficients \ of\ Variable \ 3\\
b_4: coefficients \ of\ Variable \ 4\\
$$</span> <strong>The equation is given by</strong> <span class="math display"><em>Y</em><em>h</em><em>a</em><em>t</em> = <em>a</em> + <em>b</em><sub>1</sub><em>X</em><sub>1</sub> + <em>b</em><sub>2</sub><em>X</em><sub>2</sub> + <em>b</em><sub>3</sub><em>X</em><sub>3</sub> + <em>b</em><sub>4</sub><em>X</em><sub>4</sub></span></p>
<p><strong>From the previous section we know that other good predictors of price could be:</strong></p>
<ul>
<li><code>Horsepower</code></li>
<li><code>Curb-weight</code></li>
<li><code>Engine-size</code></li>
<li><code>Highway-mpg</code></li>
</ul>
<p><strong>Let's develop a model using these variables as the predictor variables</strong></p>
</div>
<div class="cell code" data-execution_count="258">
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>lm3 <span class="op">=</span> LinearRegression() <span class="co"># creating regression variable</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> df[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]] <span class="co"># extracting multiple independent variables</span></span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Fit the linear model using the four above-mentioned variables.</span></span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a>lm3.fit(Z, df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb130-6"><a href="#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What is the value of the intercept (a)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm3.intercept_))</span>
<span id="cb130-7"><a href="#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What are the values of the coefficients (b1, b2, b3, b4)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm3.coef_))</span>
<span id="cb130-8"><a href="#cb130-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Final estimated linear model&quot;</span>)</span>
<span id="cb130-9"><a href="#cb130-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss"> Price = </span><span class="sc">{</span>lm3<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>lm3<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">*horsepower + </span><span class="sc">{</span>lm3<span class="sc">.</span>coef_[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">*curb-weight + </span><span class="sc">{</span>lm3<span class="sc">.</span>coef_[<span class="dv">2</span>]<span class="sc">}</span><span class="ss">*engine-size + </span><span class="sc">{</span>lm3<span class="sc">.</span>coef_[<span class="dv">3</span>]<span class="sc">}</span><span class="ss">*highway-mpg&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>What is the value of the intercept (a)? 
 -15811.863767729217
What are the values of the coefficients (b1, b2, b3, b4)? 
 [53.53022809  4.70805253 81.51280006 36.1593925 ]

 Final estimated linear model

 Price = -15811.863767729217 + 53.5302280860699*horsepower + 4.708052531299506*curb-weight + 81.51280005759963*engine-size + 36.15939250212034*highway-mpg
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Create and train a Multiple Linear Regression model <code>lm4</code> where the response variable is price, and the predictor variable is <code>normalized-losses</code> and <code>highway-mpg</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="259">
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>lm4 <span class="op">=</span> LinearRegression()</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>lm4.fit(df[[<span class="st">&#39;normalized-losses&#39;</span>,<span class="st">&#39;highway-mpg&#39;</span>]],df[<span class="st">&#39;price&#39;</span>]) </span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What is the value of the intercept (a)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm4.intercept_))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;What are the values of the coefficients (b1, b2, b3, b4)? </span><span class="ch">\n</span><span class="st"> </span><span class="sc">{}</span><span class="st">&quot;</span>.<span class="bu">format</span>(lm4.coef_))</span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;</span><span class="ch">\n</span><span class="st"> Estimated linear model&quot;</span>)</span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;</span><span class="ch">\n</span><span class="ss"> Price = </span><span class="sc">{</span>lm4<span class="sc">.</span>intercept_<span class="sc">}</span><span class="ss"> + </span><span class="sc">{</span>lm4<span class="sc">.</span>coef_[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">*normalized-losses  </span><span class="sc">{</span>lm4<span class="sc">.</span>coef_[<span class="dv">1</span>]<span class="sc">}</span><span class="ss">*highway-mpg &quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>What is the value of the intercept (a)? 
 38201.31327245727
What are the values of the coefficients (b1, b2, b3, b4)? 
 [   1.49789586 -820.45434016]

 Estimated linear model

 Price = 38201.31327245727 + 1.4978958634133372*normalized-losses  -820.4543401631862*highway-mpg 
</code></pre>
</div>
</div>
<div class="cell markdown">
<h3 id="2-model-evaluation-using-visualization"><code>2: Model Evaluation using Visualization</code></h3>
<p><strong>Now that we've developed some models, how do we evaluate our models and how do we choose the best one? One way to do this is by using visualization.</strong></p>
<h3 id="regression-plot"><code>Regression Plot</code></h3>
<p><strong>When it comes to simple linear regression, an excellent way to visualize the fit of our model is by using regression plots.</strong></p>
<p><strong>This plot will show a combination of a scattered data points (a scatter plot), as well as the fitted linear regression line going through the data. This will give us a reasonable estimate of the relationship between the two variables, the strength of the correlation, as well as the direction (positive or negative correlation).</strong></p>
<p><strong>Let's visualize highway-mpg as potential predictor variable of price:</strong></p>
</div>
<div class="cell code" data-execution_count="260">
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a>sns.regplot(x <span class="op">=</span> <span class="st">&#39;highway-mpg&#39;</span>, y <span class="op">=</span> <span class="st">&#39;price&#39;</span>,data <span class="op">=</span> df)</span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>plt.ylim(<span class="dv">0</span>,)</span></code></pre></div>
<div class="output execute_result" data-execution_count="260">
<pre><code>(0.0, 48172.13675907007)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/4dda814d3d6c9c72a88f485985c08b9ea79d987d.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>We can see from this plot that price is negatively correlated to highway-mpg, since the regression slope is negative. One thing to keep in mind when looking at a regression plot is to pay attention to how scattered the data points are around the regression line. This will give you a good indication of the variance of the data, and whether a linear model would be the best fit or not. If the data is too far off from the line, this linear model might not be the best model for this data.</strong></p>
<h3 id="residual-plot"><code>Residual Plot</code></h3>
<p><b> A good way to visualize the variance of the data is to use a residual plot.</p>
<p>What is a residual?</p>
<p>The difference between the observed value (y) and the predicted value (Yhat) is called the residual (e). When we look at a regression plot, the residual is the distance from the data point to the fitted regression line.</p>
<p>So what is a residual plot?</p>
<p>A residual plot is a graph that shows the residuals on the vertical y-axis and the independent variable on the horizontal x-axis.</p>
<p>What do we pay attention to when looking at a residual plot?</p>
<p>We look at the spread of the residuals:</p>
<ul>
<li>If the points in a residual plot are randomly spread out around the x-axis, then a linear model is appropriate for the data. Why is that? Randomly spread out residuals means that the variance is constant, and thus the linear model is a good fit for this data.<b></li>
</ul>
</div>
<div class="cell code" data-execution_count="261">
<div class="sourceCode" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>sns.residplot(df[<span class="st">&#39;highway-mpg&#39;</span>], df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/7cea03e2409d492afac19867415069e2683e8197.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><b>What is this plot telling us?</p>
<p>We can see from this residual plot that the residuals are not randomly spread around the x-axis, which leads us to believe that maybe a non-linear model is more appropriate for this data.</b></p>
<h3 id="multiple-linear-regression"><code>Multiple Linear Regression</code></h3>
<p><b>How do we visualize a model for Multiple Linear Regression? This gets a bit more complicated because you can't visualize it with regression or residual plot.</p>
<p>One way to look at the fit of the model is by looking at the distribution plot: We can look at the distribution of the fitted values that result from the model and compare it to the distribution of the actual values.</p>
<p>First lets make a prediction</b></p>
</div>
<div class="cell code" data-execution_count="262">
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a>Y_hat <span class="op">=</span> lm.predict(df[[<span class="st">&#39;highway-mpg&#39;</span>]])</span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;Simple Linear Regressionn&#39;</span>)</span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb137-6"><a href="#cb137-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-7"><a href="#cb137-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> sns.distplot(df[<span class="st">&#39;price&#39;</span>], hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>)</span>
<span id="cb137-9"><a href="#cb137-9" aria-hidden="true" tabindex="-1"></a>sns.distplot(Y_hat, hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;b&quot;</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb137-10"><a href="#cb137-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-11"><a href="#cb137-11" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&quot;Actual Value&quot;</span>,<span class="st">&quot;Fitted Values&quot;</span>])</span>
<span id="cb137-12"><a href="#cb137-12" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Actual vs Fitted Values for Price&#39;</span>)</span>
<span id="cb137-13"><a href="#cb137-13" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Price (in dollars)&#39;</span>)</span>
<span id="cb137-14"><a href="#cb137-14" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Proportion of Cars&#39;</span>)</span>
<span id="cb137-15"><a href="#cb137-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb137-16"><a href="#cb137-16" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb137-17"><a href="#cb137-17" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Simple Linear Regressionn
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/d4e0dbe8c6617ff2645b3327b15bc33436e38df5.png" /></p>
</div>
</div>
<div class="cell code" data-execution_count="263">
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>Y_hat <span class="op">=</span> lm3.predict(df[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]])</span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Multiple Linear Regression&quot;</span>)</span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb139-5"><a href="#cb139-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-6"><a href="#cb139-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-7"><a href="#cb139-7" aria-hidden="true" tabindex="-1"></a>ax1 <span class="op">=</span> sns.distplot(df[<span class="st">&#39;price&#39;</span>], hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>)</span>
<span id="cb139-8"><a href="#cb139-8" aria-hidden="true" tabindex="-1"></a>sns.distplot(Y_hat, hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;b&quot;</span>, ax<span class="op">=</span>ax1)</span>
<span id="cb139-9"><a href="#cb139-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-10"><a href="#cb139-10" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="st">&quot;Actual Value&quot;</span>,<span class="st">&quot;Fitted Values&quot;</span>])</span>
<span id="cb139-11"><a href="#cb139-11" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Actual vs Fitted Values for Price&#39;</span>)</span>
<span id="cb139-12"><a href="#cb139-12" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Price (in dollars)&#39;</span>)</span>
<span id="cb139-13"><a href="#cb139-13" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Proportion of Cars&#39;</span>)</span>
<span id="cb139-14"><a href="#cb139-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb139-15"><a href="#cb139-15" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb139-16"><a href="#cb139-16" aria-hidden="true" tabindex="-1"></a>plt.close()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Multiple Linear Regression
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/66ee43a13fb13de041b592ca68879317d10a7f30.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>We can see that the fitted values are reasonably close to the actual values, since the two distributions overlap a bit. However, there is definitely some room for improvement.</strong></p>
<h3 id="3-polynomial-regression-and-pipeline"><code>3: Polynomial Regression and Pipeline</code></h3>
<p><b>Polynomial regression is a particular case of the general linear regression model or multiple linear regression models.</p>
<p>We get non-linear relationships by squaring or setting higher-order terms of the predictor variables.</p>
<p>There are different orders of polynomial regression:</b></p>
<center><b>Quadratic - 2nd order</b></center>
<p><span class="math display"><em>Y</em><em>h</em><em>a</em><em>t</em> = <em>a</em> + <em>b</em><sub>1</sub><em>X</em> + <em>b</em><sub>2</sub><em>X</em><sup>2</sup></span></p>
<center><b>Cubic - 3rd order</b></center>
<p><span class="math display">$$
Yhat = a + b_1 X +b_2 X^2 +b_3 X^3\\\\
$$</span></p>
<center><b>Higher order</b>:</center>
<p><span class="math display">$$
Y = a + b_1 X +b_2 X^2 +b_3 X^3 ....\\\\
$$</span></p>
<p><strong>We saw earlier that a linear model did not provide the best fit while using highway-mpg as the predictor variable. Let's see if we can try fitting a polynomial model to the data instead.</strong></p>
<p><strong>We will use the following function to plot the data:</strong></p>
</div>
<div class="cell code" data-execution_count="264">
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Polly_Plot(model, independent_variable, dependent_variabble, Name):</span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>    x_new <span class="op">=</span> np.linspace(<span class="dv">15</span>, <span class="dv">55</span>, <span class="dv">100</span>)</span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>    y_new <span class="op">=</span> model(x_new)</span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>    plt.plot(independent_variable, dependent_variabble, <span class="st">&#39;.&#39;</span>, x_new, y_new, <span class="st">&#39;-&#39;</span>)</span>
<span id="cb141-6"><a href="#cb141-6" aria-hidden="true" tabindex="-1"></a>    plt.title(<span class="st">&#39;Polynomial Fit with Matplotlib for Price ~ Length&#39;</span>)</span>
<span id="cb141-7"><a href="#cb141-7" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> plt.gca()</span>
<span id="cb141-8"><a href="#cb141-8" aria-hidden="true" tabindex="-1"></a>    ax.set_facecolor((<span class="fl">0.898</span>, <span class="fl">0.898</span>, <span class="fl">0.898</span>))</span>
<span id="cb141-9"><a href="#cb141-9" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.gcf()</span>
<span id="cb141-10"><a href="#cb141-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(Name)</span>
<span id="cb141-11"><a href="#cb141-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Price of Cars&#39;</span>)</span>
<span id="cb141-12"><a href="#cb141-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb141-13"><a href="#cb141-13" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb141-14"><a href="#cb141-14" aria-hidden="true" tabindex="-1"></a>    plt.close()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="265">
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets get the variables</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> df[<span class="st">&#39;highway-mpg&#39;</span>]</span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">&#39;price&#39;</span>]</span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Here we use a polynomial of the 3rd order (cubic) </span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> np.polyfit(x, y, <span class="dv">3</span>)</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> np.poly1d(f)</span>
<span id="cb142-8"><a href="#cb142-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>        3         2
-1.557 x + 204.8 x - 8965 x + 1.379e+05
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's plot the function</strong></p>
</div>
<div class="cell code" data-execution_count="266">
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a>Polly_Plot(p, x, y, <span class="st">&#39;highway-mpg&#39;</span>)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/5826f0c17015dc68e9bf5c1b27c92170aa862e1e.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>We can already see from plotting that this polynomial model performs better than the linear model. This is because the generated polynomial function <code>hits</code> more of the data points.</strong></p>
<p><strong><code>Create 11 order polynomial model</code> with the variables x and y from above</strong></p>
</div>
<div class="cell code" data-execution_count="267">
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>f1 <span class="op">=</span> np.polyfit(x, y, <span class="dv">11</span>)</span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>p1 <span class="op">=</span> np.poly1d(f1)</span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(p1)</span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>Polly_Plot(p1,x,y, <span class="st">&#39;Highway MPG&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>            11             10             9           8         7
-1.243e-08 x  + 4.722e-06 x  - 0.0008028 x + 0.08056 x - 5.297 x
          6        5             4             3             2
 + 239.5 x - 7588 x + 1.684e+05 x - 2.565e+06 x + 2.551e+07 x - 1.491e+08 x + 3.879e+08
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/56b51c0f3638a9a03e5ae7a9b0059e9636e64c7e.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>The analytical expression for Multivariate Polynomial function gets complicated. For example, the expression for a second-order (degree=2)polynomial with two variables is given by:</strong></p>
<p><span class="math display"><em>Y</em><em>h</em><em>a</em><em>t</em> = <em>a</em> + <em>b</em><sub>1</sub><em>X</em><sub>1</sub> + <em>b</em><sub>2</sub><em>X</em><sub>2</sub> + <em>b</em><sub>3</sub><em>X</em><sub>1</sub><em>X</em><sub>2</sub> + <em>b</em><sub>4</sub><em>X</em><sub>1</sub><sup>2</sup> + <em>b</em><sub>5</sub><em>X</em><sub>2</sub><sup>2</sup></span></p>
<p><strong>We can perform a polynomial transform on multiple features. First, we import the module:</strong></p>
</div>
<div class="cell code" data-execution_count="268">
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> PolynomialFeatures</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We create a PolynomialFeatures object of degree 2:</strong></p>
</div>
<div class="cell code" data-execution_count="269">
<div class="sourceCode" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>pr<span class="op">=</span>PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a>pr</span></code></pre></div>
<div class="output execute_result" data-execution_count="269">
<style>#sk-container-id-12 {color: black;background-color: white;}#sk-container-id-12 pre{padding: 0;}#sk-container-id-12 div.sk-toggleable {background-color: white;}#sk-container-id-12 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-12 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-12 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-12 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-12 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-12 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-12 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-12 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-12 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-12 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-12 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-12 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-12 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-12 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-12 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-12 div.sk-item {position: relative;z-index: 1;}#sk-container-id-12 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-12 div.sk-item::before, #sk-container-id-12 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-12 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-12 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-12 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-12 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-12 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-12 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-12 div.sk-label-container {text-align: center;}#sk-container-id-12 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-12 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-12" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PolynomialFeatures()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-20" type="checkbox" checked><label for="sk-estimator-id-20" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell code" data-execution_count="270">
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a>Z_pr<span class="op">=</span>pr.fit_transform(Z)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>The original data is of 201 samples and 4 features</strong></p>
</div>
<div class="cell code" data-execution_count="271">
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a>Z.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="271">
<pre><code>(201, 4)</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>after the transformation, there 201 samples and 15 features</strong></p>
</div>
<div class="cell code" data-execution_count="272">
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a>Z_pr.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="272">
<pre><code>(201, 15)</code></pre>
</div>
</div>
<section id="pipeline" class="cell markdown">
<h3><code>Pipeline</code></h3>
<p><strong>Data Pipelines simplify the steps of processing the data. We use the module Pipeline to create a pipeline. We also use StandardScaler - to Normalize the data as a step in our pipeline .</strong></p>
</section>
<div class="cell code" data-execution_count="273">
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.pipeline <span class="im">import</span> Pipeline</span>
<span id="cb154-2"><a href="#cb154-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We create the pipeline, by creating a list of tuples including the name of the model or estimator and its corresponding constructor.</strong></p>
</div>
<div class="cell code" data-execution_count="274">
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>Input<span class="op">=</span>[(<span class="st">&#39;scale&#39;</span>,StandardScaler()), (<span class="st">&#39;polynomial&#39;</span>, PolynomialFeatures(include_bias<span class="op">=</span><span class="va">False</span>)), (<span class="st">&#39;model&#39;</span>,LinearRegression())]</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>we input the list as an argument to the pipeline constructor</strong></p>
</div>
<div class="cell code" data-execution_count="275">
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>pipe<span class="op">=</span>Pipeline(Input)</span>
<span id="cb156-2"><a href="#cb156-2" aria-hidden="true" tabindex="-1"></a>pipe</span></code></pre></div>
<div class="output execute_result" data-execution_count="275">
<style>#sk-container-id-13 {color: black;background-color: white;}#sk-container-id-13 pre{padding: 0;}#sk-container-id-13 div.sk-toggleable {background-color: white;}#sk-container-id-13 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-13 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-13 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-13 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-13 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-13 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-13 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-13 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-13 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-13 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-13 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-13 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-13 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-13 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-13 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-13 div.sk-item {position: relative;z-index: 1;}#sk-container-id-13 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-13 div.sk-item::before, #sk-container-id-13 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-13 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-13 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-13 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-13 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-13 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-13 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-13 div.sk-label-container {text-align: center;}#sk-container-id-13 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-13 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-13" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scale&#x27;, StandardScaler()),
                (&#x27;polynomial&#x27;, PolynomialFeatures(include_bias=False)),
                (&#x27;model&#x27;, LinearRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-21" type="checkbox" ><label for="sk-estimator-id-21" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scale&#x27;, StandardScaler()),
                (&#x27;polynomial&#x27;, PolynomialFeatures(include_bias=False)),
                (&#x27;model&#x27;, LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-22" type="checkbox" ><label for="sk-estimator-id-22" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-23" type="checkbox" ><label for="sk-estimator-id-23" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(include_bias=False)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-24" type="checkbox" ><label for="sk-estimator-id-24" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>We can normalize the data, perform a transform and fit the model simultaneously.</strong></p>
</div>
<div class="cell code" data-execution_count="276">
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>pipe.fit(Z,y)</span></code></pre></div>
<div class="output execute_result" data-execution_count="276">
<style>#sk-container-id-14 {color: black;background-color: white;}#sk-container-id-14 pre{padding: 0;}#sk-container-id-14 div.sk-toggleable {background-color: white;}#sk-container-id-14 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-14 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-14 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-14 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-14 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-14 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-14 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-14 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-14 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-14 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-14 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-14 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-14 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-14 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-14 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-14 div.sk-item {position: relative;z-index: 1;}#sk-container-id-14 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-14 div.sk-item::before, #sk-container-id-14 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-14 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-14 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-14 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-14 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-14 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-14 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-14 div.sk-label-container {text-align: center;}#sk-container-id-14 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-14 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-14" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Pipeline(steps=[(&#x27;scale&#x27;, StandardScaler()),
                (&#x27;polynomial&#x27;, PolynomialFeatures(include_bias=False)),
                (&#x27;model&#x27;, LinearRegression())])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-25" type="checkbox" ><label for="sk-estimator-id-25" class="sk-toggleable__label sk-toggleable__label-arrow">Pipeline</label><div class="sk-toggleable__content"><pre>Pipeline(steps=[(&#x27;scale&#x27;, StandardScaler()),
                (&#x27;polynomial&#x27;, PolynomialFeatures(include_bias=False)),
                (&#x27;model&#x27;, LinearRegression())])</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-26" type="checkbox" ><label for="sk-estimator-id-26" class="sk-toggleable__label sk-toggleable__label-arrow">StandardScaler</label><div class="sk-toggleable__content"><pre>StandardScaler()</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-27" type="checkbox" ><label for="sk-estimator-id-27" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(include_bias=False)</pre></div></div></div><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-28" type="checkbox" ><label for="sk-estimator-id-28" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>Similarly, we can normalize the data, perform a transform and produce a prediction simultaneously</strong></p>
</div>
<div class="cell code" data-execution_count="277">
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>ypipe<span class="op">=</span>pipe.predict(Z)</span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>ypipe[<span class="dv">0</span>:<span class="dv">4</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="277">
<pre><code>array([13102.93329646, 13102.93329646, 18226.43450275, 10391.09183955])</code></pre>
</div>
</div>
<section id="4-measures-for-in-sample-evaluation" class="cell markdown">
<h3><code>4: Measures for In-Sample Evaluation</code></h3>
<p><b>When evaluating our models, not only do we want to visualize the results, but we also want a quantitative measure to determine how accurate the model is.</p>
<p>Two very important measures that are often used in Statistics to determine the accuracy of a model are:</p>
<ul>
<li>R^2 / R-squared</li>
<li>Mean Squared Error (MSE)</li>
</ul>
<p>R-squared R squared, also known as the coefficient of determination, is a measure to indicate how close the data is to the fitted regression line.</p>
<p>The value of the R-squared is the percentage of variation of the response variable (y) that is explained by a linear model.</p>
<p>Mean Squared Error (MSE)</p>
<p>The Mean Squared Error measures the average of the squares of errors, that is, the difference between actual value (y) and the estimated value (ŷ).</b></p>
</section>
<div class="cell markdown">
<p><strong>Let's calculate the R^2</strong></p>
</div>
<div class="cell code" data-execution_count="278">
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="co">#highway_mpg_fit</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df[[<span class="st">&#39;highway-mpg&#39;</span>]]</span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a>Y <span class="op">=</span> df[<span class="st">&#39;price&#39;</span>]</span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a>lm.fit(X, Y)</span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the R^2</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The R-square is: &#39;</span>, lm.score(X, Y))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The R-square is:  0.4965911884339176
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can say that ~ 49.659% of the variation of the price is explained by this simple linear model <code>horsepower_fit</code>.</strong></p>
<p><strong>To calculate the MSE</strong></p>
<p><strong>lets import the function mean_squared_error from the module metrics</strong></p>
</div>
<div class="cell code" data-execution_count="279">
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> mean_squared_error</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>we compare the predicted results with the actual results</strong></p>
</div>
<div class="cell code" data-execution_count="280">
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="#cb163-1" aria-hidden="true" tabindex="-1"></a>Yhat<span class="op">=</span>lm.predict(X)</span>
<span id="cb163-2"><a href="#cb163-2" aria-hidden="true" tabindex="-1"></a>mse <span class="op">=</span> mean_squared_error(df[<span class="st">&#39;price&#39;</span>], Yhat)</span>
<span id="cb163-3"><a href="#cb163-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The mean square error of price and predicted value is: &#39;</span>, mse)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The mean square error of price and predicted value is:  31635042.944639888
</code></pre>
</div>
</div>
<section id="model-2-multiple-linear-regression" class="cell markdown">
<h4>Model <code>2: Multiple Linear Regression</code></h4>
</section>
<div class="cell markdown">
<p><strong>Let's calculate the R^2</strong></p>
</div>
<div class="cell code" data-execution_count="281">
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="#cb165-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fit the model </span></span>
<span id="cb165-2"><a href="#cb165-2" aria-hidden="true" tabindex="-1"></a>lm.fit(Z, df[<span class="st">&#39;price&#39;</span>])</span>
<span id="cb165-3"><a href="#cb165-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Find the R^2</span></span>
<span id="cb165-4"><a href="#cb165-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The R-square is: &#39;</span>, lm.score(Z, df[<span class="st">&#39;price&#39;</span>]))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The R-square is:  0.8093732522175299
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><b>We can say that ~ 80.896 % of the variation of price is explained by this multiple linear regression "multi_fit".</p>
<p>Let's calculate the MSE</p>
<p>we produce a prediction</b></p>
</div>
<div class="cell code" data-execution_count="282">
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="#cb167-1" aria-hidden="true" tabindex="-1"></a>Y_predict_multifit <span class="op">=</span> lm.predict(Z)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>we compare the predicted results with the actual results</strong></p>
</div>
<div class="cell code" data-execution_count="283">
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The mean square error of price and predicted value using multifit is: &#39;</span>, <span class="op">\</span></span>
<span id="cb168-2"><a href="#cb168-2" aria-hidden="true" tabindex="-1"></a>      mean_squared_error(df[<span class="st">&#39;price&#39;</span>], Y_predict_multifit))</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The mean square error of price and predicted value using multifit is:  11979300.349818882
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong><code>Model 3: Polynomial Fit</code></strong></p>
<p><strong>To calculate the R^2, let’s import the function r2_score from the module metrics as we are using a different function</strong></p>
</div>
<div class="cell code" data-execution_count="284">
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> r2_score</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We apply the function to get the value of r^2</strong></p>
</div>
<div class="cell code" data-execution_count="285">
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="#cb171-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> r2_score(y, p(x)) <span class="co"># degree 3 polynomial</span></span>
<span id="cb171-2"><a href="#cb171-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The R-square value is: &#39;</span>, r_squared)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The R-square value is:  0.674194666390652
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can say that ~ 67.419 % of the variation of price is explained by this polynomial fit</strong></p>
<p><strong>We can also calculate the MSE:</strong></p>
</div>
<div class="cell code" data-execution_count="286">
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="#cb173-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(df[<span class="st">&#39;price&#39;</span>], p(x)) <span class="co"># degree 3 polynomial</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="286">
<pre><code>20474146.426361218</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="287">
<div class="sourceCode" id="cb175"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="#cb175-1" aria-hidden="true" tabindex="-1"></a>r_squared <span class="op">=</span> r2_score(y, p1(x)) <span class="co">#  degree 11 polynomial</span></span>
<span id="cb175-2"><a href="#cb175-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;The R-square value is: &#39;</span>, r_squared)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The R-square value is:  0.702376909204032
</code></pre>
</div>
</div>
<div class="cell code" data-execution_count="288">
<div class="sourceCode" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="#cb177-1" aria-hidden="true" tabindex="-1"></a>mean_squared_error(df[<span class="st">&#39;price&#39;</span>], p1(x)) <span class="co"># degree 11 polynomial</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="288">
<pre><code>18703127.64164033</code></pre>
</div>
</div>
<section id="5-prediction-and-decision-making" class="cell markdown">
<h3><code>5: Prediction and Decision Making</code></h3>
<h4 id="prediction"><code>Prediction</code></h4>
<p><strong>In the previous section, we trained the model using the method fit. Now we will use the method predict to produce a prediction. we will use pyplot for plotting, also be using some functions from numpy.</strong></p>
</section>
<div class="cell markdown">
<p><strong>Create a new input</strong></p>
</div>
<div class="cell code" data-execution_count="289">
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="#cb179-1" aria-hidden="true" tabindex="-1"></a>new_input<span class="op">=</span>np.arange(<span class="dv">1</span>, <span class="dv">101</span>, <span class="dv">1</span>).reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>) <span class="co"># 100 sample inputs</span></span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>Fit the model</strong></p>
</div>
<div class="cell code" data-execution_count="290">
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="#cb180-1" aria-hidden="true" tabindex="-1"></a>lm.fit(X, Y)</span>
<span id="cb180-2"><a href="#cb180-2" aria-hidden="true" tabindex="-1"></a>lm</span></code></pre></div>
<div class="output execute_result" data-execution_count="290">
<style>#sk-container-id-15 {color: black;background-color: white;}#sk-container-id-15 pre{padding: 0;}#sk-container-id-15 div.sk-toggleable {background-color: white;}#sk-container-id-15 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-15 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-15 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-15 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-15 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-15 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-15 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-15 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-15 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-15 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-15 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-15 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-15 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-15 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-15 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-15 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-15 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-15 div.sk-item {position: relative;z-index: 1;}#sk-container-id-15 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-15 div.sk-item::before, #sk-container-id-15 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-15 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-15 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-15 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-15 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-15 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-15 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-15 div.sk-label-container {text-align: center;}#sk-container-id-15 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-15 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-15" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-29" type="checkbox" checked><label for="sk-estimator-id-29" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>Produce a prediction</strong></p>
</div>
<div class="cell code" data-execution_count="291">
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="#cb181-1" aria-hidden="true" tabindex="-1"></a>yhat<span class="op">=</span>lm.predict(new_input)</span>
<span id="cb181-2"><a href="#cb181-2" aria-hidden="true" tabindex="-1"></a>yhat[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="291">
<pre><code>array([37601.57247984, 36779.83910151, 35958.10572319, 35136.37234487,
       34314.63896655])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>we can plot the data</strong></p>
</div>
<div class="cell code" data-execution_count="292">
<div class="sourceCode" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="#cb183-1" aria-hidden="true" tabindex="-1"></a>plt.plot(new_input, yhat)</span>
<span id="cb183-2"><a href="#cb183-2" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/b7ef634503703c7166dc0de95b4ed3483ef15e81.png" /></p>
</div>
</div>
<div class="cell markdown">
<h3 id="decision-making-determining-a-good-model-fit"><code>Decision Making: Determining a Good Model Fit</code></h3>
<p><b> Now that we have visualized the different models, and generated the R-squared and MSE values for the fits, how do we determine a good model fit?</p>
<p>What is a good R-squared value? When comparing models, the model with the higher R-squared value is a better fit for the data.</p>
<p>What is a good MSE? When comparing models, the model with the smallest MSE value is a better fit for the data. </b></p>
<p><strong><code>Let's take a look at the values for the different models.</code></strong></p>
<p><strong>Simple Linear Regression: Using Highway-mpg as a Predictor Variable of Price.</strong></p>
<ul>
<li>R-squared: 0.49659118843391759</li>
<li>MSE: 3.16 x10^7</li>
</ul>
<p><strong>Multiple Linear Regression: Using Horsepower, Curb-weight, Engine-size, and Highway-mpg as Predictor Variables of Price.</strong></p>
<ul>
<li>R-squared: 0.80896354913783497</li>
<li>MSE: 1.2 x10^7</li>
</ul>
<p><strong>Polynomial Fit: Using Highway-mpg as a Predictor Variable of Price.</strong></p>
<ul>
<li>R-squared: 0.6741946663906514</li>
<li>MSE: 2.05 x 10^7</li>
</ul>
<p><strong><code>Simple Linear Regression model (SLR) vs Multiple Linear Regression model (MLR)</code></strong> <strong>Usually, the more variables you have, the better your model is at predicting, but this is not always true. Sometimes you may not have enough data, you may run into numerical problems, or many of the variables may not be useful and or even act as noise. As a result, you should always check the MSE and R^2.</strong></p>
<p><strong>So to be able to compare the results of the MLR vs SLR models, we look at a combination of both the R-squared and MSE to make the best conclusion about the fit of the model.</strong></p>
<ul>
<li>MSE: The MSE of SLR is 3.16x10^7 while MLR has an MSE of 1.2 x10^7. The MSE of MLR is much smaller.</li>
<li>R-squared: In this case, we can also see that there is a big difference between the R-squared of the SLR and the R-squared of the MLR. The R-squared for the SLR (0.497) is very small compared to the R-squared for the MLR (0.809).</li>
</ul>
<p><strong>This R-squared in combination with the MSE show that MLR seems like the better model fit in this case, compared to SLR.</strong></p>
<p><strong><code>Simple Linear Model (SLR) vs Polynomial Fit</code></strong></p>
<ul>
<li>MSE: We can see that Polynomial Fit brought down the MSE, since this MSE is smaller than the one from the SLR.</li>
<li>R-squared: The R-squared for the Polyfit is larger than the R-squared for the SLR, so the Polynomial Fit also brought up the R-squared quite a bit.</li>
</ul>
<p><strong>Since the Polynomial Fit resulted in a lower MSE and a higher R-squared, we can conclude that this was a better fit model than the simple linear regression for predicting Price with Highway-mpg as a predictor variable.</strong></p>
<p><strong><code>Multiple Linear Regression (MLR) vs Polynomial Fit</code></strong></p>
<ul>
<li>MSE: The MSE for the MLR is smaller than the MSE for the Polynomial Fit.</li>
<li>R-squared: The R-squared for the MLR is also much larger than for the Polynomial Fit.</li>
</ul>
<h3 id="r-squared-in-combination-with-the-mse-show-that-mlr-seems-like-the-better-model-fit-in-this-case-compared-to-slr-and-polynomial-fit">R-Squared in combination with the MSE show that MLR seems like the better model fit in this case, compared to SLR and Polynomial Fit.</h3>
</div>
<section id="model-evaluation-and-refinement" class="cell markdown">
<h2><code>Model Evaluation and Refinement</code></h2>
<p><br> <b> In the previous section, we have evalulated the model using in-sample evaluation. <code>In-sample evaluation tells us how well our model fits the data already given to train it. It does not give us an estimate of how well the train model can predict new data.</code> The solution is to split our data up, use the in-sample data or training data to train the model. The rest of the data, called Test Data, is used as out-of-sample data. This data is then used to approximate, how the model performs in the real world. Separating data into training and testing sets is an important part of model evaluation. We use the test data to get an idea how our model will perform in the real world. </b></p>
</section>
<div class="cell markdown">
<p><strong><code>Functions for Plotting</code></strong></p>
</div>
<div class="cell code" data-execution_count="293">
<div class="sourceCode" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> DistributionPlot(RedFunction, BlueFunction, RedName, BlueName, Title): <span class="co"># red function : actual, Blue Function : predicted</span></span>
<span id="cb184-2"><a href="#cb184-2" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb184-3"><a href="#cb184-3" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb184-4"><a href="#cb184-4" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb184-5"><a href="#cb184-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-6"><a href="#cb184-6" aria-hidden="true" tabindex="-1"></a>    ax1 <span class="op">=</span> sns.distplot(RedFunction, hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;r&quot;</span>, label<span class="op">=</span>RedName)</span>
<span id="cb184-7"><a href="#cb184-7" aria-hidden="true" tabindex="-1"></a>    ax2 <span class="op">=</span> sns.distplot(BlueFunction, hist<span class="op">=</span><span class="va">False</span>, color<span class="op">=</span><span class="st">&quot;b&quot;</span>, label<span class="op">=</span>BlueName, ax<span class="op">=</span>ax1)</span>
<span id="cb184-8"><a href="#cb184-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-9"><a href="#cb184-9" aria-hidden="true" tabindex="-1"></a>    plt.title(Title)</span>
<span id="cb184-10"><a href="#cb184-10" aria-hidden="true" tabindex="-1"></a>    plt.xlabel(<span class="st">&#39;Price (in dollars)&#39;</span>)</span>
<span id="cb184-11"><a href="#cb184-11" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Proportion of Cars&#39;</span>)</span>
<span id="cb184-12"><a href="#cb184-12" aria-hidden="true" tabindex="-1"></a>    plt.legend([RedName,BlueName])</span>
<span id="cb184-13"><a href="#cb184-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb184-14"><a href="#cb184-14" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb184-15"><a href="#cb184-15" aria-hidden="true" tabindex="-1"></a>    plt.close()</span></code></pre></div>
</div>
<div class="cell code" data-execution_count="294">
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> PollyPlot(xtrain, xtest, y_train, y_test, lr,poly_transform):</span>
<span id="cb185-2"><a href="#cb185-2" aria-hidden="true" tabindex="-1"></a>    width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb185-3"><a href="#cb185-3" aria-hidden="true" tabindex="-1"></a>    height <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb185-4"><a href="#cb185-4" aria-hidden="true" tabindex="-1"></a>    plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb185-5"><a href="#cb185-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-6"><a href="#cb185-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb185-7"><a href="#cb185-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">#training data </span></span>
<span id="cb185-8"><a href="#cb185-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">#testing data </span></span>
<span id="cb185-9"><a href="#cb185-9" aria-hidden="true" tabindex="-1"></a>    <span class="co"># lr:  linear regression object </span></span>
<span id="cb185-10"><a href="#cb185-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#poly_transform:  polynomial transformation object </span></span>
<span id="cb185-11"><a href="#cb185-11" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb185-12"><a href="#cb185-12" aria-hidden="true" tabindex="-1"></a>    xmax<span class="op">=</span><span class="bu">max</span>([xtrain.values.<span class="bu">max</span>(), xtest.values.<span class="bu">max</span>()])</span>
<span id="cb185-13"><a href="#cb185-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-14"><a href="#cb185-14" aria-hidden="true" tabindex="-1"></a>    xmin<span class="op">=</span><span class="bu">min</span>([xtrain.values.<span class="bu">min</span>(), xtest.values.<span class="bu">min</span>()])</span>
<span id="cb185-15"><a href="#cb185-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-16"><a href="#cb185-16" aria-hidden="true" tabindex="-1"></a>    x<span class="op">=</span>np.arange(xmin, xmax, <span class="fl">0.1</span>)</span>
<span id="cb185-17"><a href="#cb185-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-18"><a href="#cb185-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb185-19"><a href="#cb185-19" aria-hidden="true" tabindex="-1"></a>    plt.plot(xtrain, y_train, <span class="st">&#39;or&#39;</span>, label<span class="op">=</span><span class="st">&#39;Training Data&#39;</span>)</span>
<span id="cb185-20"><a href="#cb185-20" aria-hidden="true" tabindex="-1"></a>    plt.plot(xtest, y_test, <span class="st">&#39;og&#39;</span>, label<span class="op">=</span><span class="st">&#39;Test Data&#39;</span>)</span>
<span id="cb185-21"><a href="#cb185-21" aria-hidden="true" tabindex="-1"></a>    plt.plot(x, lr.predict(poly_transform.fit_transform(x.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>))), label<span class="op">=</span><span class="st">&#39;Predicted Function&#39;</span>)</span>
<span id="cb185-22"><a href="#cb185-22" aria-hidden="true" tabindex="-1"></a>    plt.ylim([<span class="op">-</span><span class="dv">10000</span>, <span class="dv">60000</span>])</span>
<span id="cb185-23"><a href="#cb185-23" aria-hidden="true" tabindex="-1"></a>    plt.ylabel(<span class="st">&#39;Price&#39;</span>)</span>
<span id="cb185-24"><a href="#cb185-24" aria-hidden="true" tabindex="-1"></a>    plt.legend()</span></code></pre></div>
</div>
<section id="part-1-training-and-testing" class="cell markdown">
<h3><code>Part 1: Training and Testing</code></h3>
<p><strong>An important step in testing your model is to split your data into training and testing data.</strong></p>
</section>
<div class="cell code" data-execution_count="295">
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="co"># We will place the target data price in a separate dataframe y:</span></span>
<span id="cb186-2"><a href="#cb186-2" aria-hidden="true" tabindex="-1"></a>y_data <span class="op">=</span> df[<span class="st">&#39;price&#39;</span>] </span>
<span id="cb186-3"><a href="#cb186-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb186-4"><a href="#cb186-4" aria-hidden="true" tabindex="-1"></a><span class="co">#drop price data in x data</span></span>
<span id="cb186-5"><a href="#cb186-5" aria-hidden="true" tabindex="-1"></a>x_data <span class="op">=</span> df.drop(<span class="st">&#39;price&#39;</span>,axis<span class="op">=</span><span class="dv">1</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>Now we randomly split our data into training and testing data using the function train_test_split.</strong></p>
</div>
<div class="cell code" data-execution_count="296">
<div class="sourceCode" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split</span>
<span id="cb187-2"><a href="#cb187-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-3"><a href="#cb187-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-4"><a href="#cb187-4" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_data, y_data, test_size<span class="op">=</span><span class="fl">0.10</span>, random_state<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb187-5"><a href="#cb187-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-6"><a href="#cb187-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb187-7"><a href="#cb187-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;number of test samples :&quot;</span>, x_test.shape[<span class="dv">0</span>])</span>
<span id="cb187-8"><a href="#cb187-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;number of training samples:&quot;</span>,x_train.shape[<span class="dv">0</span>])</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of test samples : 21
number of training samples: 180
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>The test_size parameter sets the proportion of data that is split into the testing set. In the above, the testing set is set to 10% of the total dataset.</strong></p>
</div>
<div class="cell markdown">
<p><strong>Let's Calculate the R^2 on the test data (x_train, x_test, y_train, y_test):</strong></p>
</div>
<div class="cell code" data-execution_count="297">
<div class="sourceCode" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="co"># let&#39;s import LinearRegression from the module linear_model.</span></span>
<span id="cb189-2"><a href="#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> LinearRegression</span>
<span id="cb189-3"><a href="#cb189-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-4"><a href="#cb189-4" aria-hidden="true" tabindex="-1"></a><span class="co">#We create a Linear Regression object:</span></span>
<span id="cb189-5"><a href="#cb189-5" aria-hidden="true" tabindex="-1"></a>lre<span class="op">=</span>LinearRegression()</span>
<span id="cb189-6"><a href="#cb189-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-7"><a href="#cb189-7" aria-hidden="true" tabindex="-1"></a><span class="co">#we fit the model using the feature horsepower</span></span>
<span id="cb189-8"><a href="#cb189-8" aria-hidden="true" tabindex="-1"></a>lre.fit(x_train[[<span class="st">&#39;horsepower&#39;</span>]], y_train)</span>
<span id="cb189-9"><a href="#cb189-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-10"><a href="#cb189-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s Calculate the R^2 on the test data:</span></span>
<span id="cb189-11"><a href="#cb189-11" aria-hidden="true" tabindex="-1"></a>test <span class="op">=</span>  lre.score(x_test[[<span class="st">&#39;horsepower&#39;</span>]], y_test)</span>
<span id="cb189-12"><a href="#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;the R^2 on the Test data:&#39;</span>, test)</span>
<span id="cb189-13"><a href="#cb189-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-14"><a href="#cb189-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s Calculate the R^2 on the Train data:</span></span>
<span id="cb189-15"><a href="#cb189-15" aria-hidden="true" tabindex="-1"></a>train <span class="op">=</span> lre.score(x_train[[<span class="st">&#39;horsepower&#39;</span>]], y_train)</span>
<span id="cb189-16"><a href="#cb189-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;the R^2 on the Train data:&#39;</span>, train)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>the R^2 on the Test data: 0.3635480624962413
the R^2 on the Train data: 0.662028747521533
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>we can see the R^2 is much smaller using the test data. This is because almost 90% of the data is used to train the model becuase of which the model is able of explain 66% of the seen data(i.e. 90% of the total data) and only 10% of the data to test it because of which it can explain only 36% of that unseen 10% data. In short, the model has good accuracy but very low precision.</strong></p>
<p><strong>Now, let's split up the data set such that 40% of the data samples will be utilized for testing, set the parameter "random_state" equal to zero. The output of the function should be the following: "x_train_1" , "x_test_1", "y_train_1" and "y_test_1"</strong></p>
</div>
<div class="cell code" data-execution_count="298">
<div class="sourceCode" id="cb191"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="#cb191-1" aria-hidden="true" tabindex="-1"></a>x_train1,x_test1, y_train1,  y_test1 <span class="op">=</span> train_test_split(x_data, y_data,test_size<span class="op">=</span><span class="fl">0.4</span>, random_state<span class="op">=</span><span class="dv">0</span> )</span>
<span id="cb191-2"><a href="#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;number of test samples :&quot;</span>, x_test1.shape[<span class="dv">0</span>])</span>
<span id="cb191-3"><a href="#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;number of training samples:&quot;</span>,x_train1.shape[<span class="dv">0</span>])</span>
<span id="cb191-4"><a href="#cb191-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-5"><a href="#cb191-5" aria-hidden="true" tabindex="-1"></a><span class="co"># training model and calculating R^2</span></span>
<span id="cb191-6"><a href="#cb191-6" aria-hidden="true" tabindex="-1"></a>lre1<span class="op">=</span>LinearRegression()</span>
<span id="cb191-7"><a href="#cb191-7" aria-hidden="true" tabindex="-1"></a>lre1.fit(x_train1[[<span class="st">&#39;horsepower&#39;</span>]], y_train1)</span>
<span id="cb191-8"><a href="#cb191-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s Calculate the R^2 on the test data:</span></span>
<span id="cb191-9"><a href="#cb191-9" aria-hidden="true" tabindex="-1"></a>test1 <span class="op">=</span>  lre1.score(x_test1[[<span class="st">&#39;horsepower&#39;</span>]], y_test1)</span>
<span id="cb191-10"><a href="#cb191-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;the R^2 on the Test data:&#39;</span>, test1)</span>
<span id="cb191-11"><a href="#cb191-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-12"><a href="#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s Calculate the R^2 on the Train data:</span></span>
<span id="cb191-13"><a href="#cb191-13" aria-hidden="true" tabindex="-1"></a>train1 <span class="op">=</span> lre1.score(x_train1[[<span class="st">&#39;horsepower&#39;</span>]], y_train1)</span>
<span id="cb191-14"><a href="#cb191-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;the R^2 on the Train data:&#39;</span>, train1)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>number of test samples : 81
number of training samples: 120
the R^2 on the Test data: 0.7139737368233016
the R^2 on the Train data: 0.5754853866574969
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can see a big jump precision to 71% from 36% and slight drop in accuracy from 66% to 57%. But this model can predict real world data more precisely.</strong></p>
</div>
<section id="cross-validation-score" class="cell markdown">
<h3><code>Cross-validation Score</code></h3>
<p><strong>Sometimes you do not have sufficient testing data; as a result, you may want to perform Cross-validation. Let's go over several methods that you can use for Cross-validation.</strong></p>
</section>
<div class="cell code" data-execution_count="299">
<div class="sourceCode" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Lets import model_selection from the module cross_val_score.</span></span>
<span id="cb193-2"><a href="#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_score</span>
<span id="cb193-3"><a href="#cb193-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-4"><a href="#cb193-4" aria-hidden="true" tabindex="-1"></a><span class="co"># We input the object, the feature in this case &#39; horsepower&#39;, the target data (y_data).</span></span>
<span id="cb193-5"><a href="#cb193-5" aria-hidden="true" tabindex="-1"></a><span class="co"># The parameter &#39;cv&#39; determines the number of folds; in this case 4.</span></span>
<span id="cb193-6"><a href="#cb193-6" aria-hidden="true" tabindex="-1"></a>Rcross <span class="op">=</span> cross_val_score(lre, x_data[[<span class="st">&#39;horsepower&#39;</span>]], y_data, cv<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb193-7"><a href="#cb193-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-8"><a href="#cb193-8" aria-hidden="true" tabindex="-1"></a><span class="co"># The default scoring is R^2; each element in the array has the average R^2 value in the fold:</span></span>
<span id="cb193-9"><a href="#cb193-9" aria-hidden="true" tabindex="-1"></a>Rcross</span></code></pre></div>
<div class="output execute_result" data-execution_count="299">
<pre><code>array([0.77465419, 0.51718424, 0.74814454, 0.04825398])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We can calculate the average and standard deviation of our estimate:</strong></p>
</div>
<div class="cell code" data-execution_count="300">
<div class="sourceCode" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="#cb195-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The mean of the folds are&quot;</span>, Rcross.mean(), <span class="st">&quot;and the standard deviation is&quot;</span> , Rcross.std())</span></code></pre></div>
<div class="output stream stdout">
<pre><code>The mean of the folds are 0.5220592359225417 and the standard deviation is 0.291304806661184
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>You can also use the function <code>cross_val_predict</code> to predict the output. The function splits up the data into the specified number of folds, using one fold for testing and the other folds are used for training. First import the function:</strong></p>
</div>
<div class="cell code" data-execution_count="301">
<div class="sourceCode" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> cross_val_predict</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We input the object, the feature in this case <code>horsepower</code> , the target data y_data. The parameter <code>cv</code> determines the number of folds; in this case 4. We can produce an output that was obtained for each element when it was in the test set.:</strong></p>
</div>
<div class="cell code" data-execution_count="302">
<div class="sourceCode" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="#cb198-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> cross_val_predict(lre,x_data[[<span class="st">&#39;horsepower&#39;</span>]], y_data,cv<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb198-2"><a href="#cb198-2" aria-hidden="true" tabindex="-1"></a>yhat[<span class="dv">0</span>:<span class="dv">5</span>] <span class="co"># yhat has total 201 values</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="302">
<pre><code>array([14142.23793549, 14142.23793549, 20815.3029844 , 12745.549902  ,
       14762.9881726 ])</code></pre>
</div>
</div>
<section id="part-2-overfitting-underfitting-and-model-selection" class="cell markdown">
<h3><code>Part 2: Overfitting, Underfitting and Model Selection</code></h3>
<p><strong>It turns out that the test data sometimes referred to as the out of sample data is a much better measure of how well your model performs in the real world. One reason for this is overfitting; let's go over some examples. It turns out these differences are more apparent in Multiple Linear Regression and Polynomial Regression so we will explore overfitting in that context.</strong></p>
</section>
<div class="cell markdown">
<p><strong>Let's create Multiple linear regression objects and train the model using 'horsepower', 'curb-weight', 'engine-size' and 'highway-mpg' as features.</strong></p>
</div>
<div class="cell code" data-execution_count="303">
<div class="sourceCode" id="cb200"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="#cb200-1" aria-hidden="true" tabindex="-1"></a>lr <span class="op">=</span> LinearRegression()</span>
<span id="cb200-2"><a href="#cb200-2" aria-hidden="true" tabindex="-1"></a>lr.fit(x_train[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]], y_train) <span class="co"># 10% test data</span></span></code></pre></div>
<div class="output execute_result" data-execution_count="303">
<style>#sk-container-id-16 {color: black;background-color: white;}#sk-container-id-16 pre{padding: 0;}#sk-container-id-16 div.sk-toggleable {background-color: white;}#sk-container-id-16 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-16 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-16 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-16 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-16 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-16 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-16 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-16 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-16 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-16 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-16 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-16 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-16 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-16 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-16 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-16 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-16 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-16 div.sk-item {position: relative;z-index: 1;}#sk-container-id-16 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-16 div.sk-item::before, #sk-container-id-16 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-16 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-16 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-16 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-16 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-16 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-16 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-16 div.sk-label-container {text-align: center;}#sk-container-id-16 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-16 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-16" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-30" type="checkbox" checked><label for="sk-estimator-id-30" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>Prediction using training data:</strong></p>
</div>
<div class="cell code" data-execution_count="304">
<div class="sourceCode" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="#cb201-1" aria-hidden="true" tabindex="-1"></a>yhat_train <span class="op">=</span> lr.predict(x_train[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]]) </span>
<span id="cb201-2"><a href="#cb201-2" aria-hidden="true" tabindex="-1"></a>yhat_train[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="304">
<pre><code>array([ 7426.34910902, 28324.42490838, 14212.74872339,  4052.80810192,
       34499.8541269 ])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Prediction using test data:</strong></p>
</div>
<div class="cell code" data-execution_count="305">
<div class="sourceCode" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="#cb203-1" aria-hidden="true" tabindex="-1"></a>yhat_test <span class="op">=</span> lr.predict(x_test[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]]) </span>
<span id="cb203-2"><a href="#cb203-2" aria-hidden="true" tabindex="-1"></a>yhat_test[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="305">
<pre><code>array([11349.68099115,  5884.25292475, 11208.31007475,  6641.03017109,
       15565.98722248])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's perform some model evaluation using our training and testing data separately.</strong></p>
</div>
<div class="cell code" data-execution_count="306">
<div class="sourceCode" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="#cb205-1" aria-hidden="true" tabindex="-1"></a>Title <span class="op">=</span> <span class="st">&#39;Distribution  Plot of  Predicted Value Using Training Data vs Training Data Distribution&#39;</span> </span>
<span id="cb205-2"><a href="#cb205-2" aria-hidden="true" tabindex="-1"></a>DistributionPlot(y_train, yhat_train, <span class="st">&quot;Actual Values (Train)&quot;</span>, <span class="st">&quot;Predicted Values (Train)&quot;</span>, Title) </span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/b8dc1a3856dffe15c686c049d34fe2297d0ccfcb.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>Figure 1: Plot of predicted values using the training data compared to the training data.</strong></p>
<p><strong>So far the model seems to be doing well in learning from the training dataset. But what happens when the model encounters new data from the testing dataset? When the model generates new values from the test data, we see the distribution of the predicted values is much different from the actual target values.</strong></p>
</div>
<div class="cell code" data-execution_count="307">
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="#cb206-1" aria-hidden="true" tabindex="-1"></a>Title<span class="op">=</span><span class="st">&#39;Distribution  Plot of  Predicted Value Using Test Data vs Data Distribution of Test Data&#39;</span></span>
<span id="cb206-2"><a href="#cb206-2" aria-hidden="true" tabindex="-1"></a>DistributionPlot(y_test,yhat_test,<span class="st">&quot;Actual Values (Test)&quot;</span>,<span class="st">&quot;Predicted Values (Test)&quot;</span>,Title)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/b7721081e883d249177d2877bd37612d6e54cff5.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>Figur 2: Plot of predicted value using the test data compared to the test data.</strong></p>
<p><strong>Comparing Figure 1 and Figure 2; it is evident the distribution of the test data in Figure 1 is much better at fitting the data. This difference in Figure 2 is apparent where the ranges are from 5000 to 15 000. This is where the distribution shape is exceptionally different. Let's see if polynomial regression also exhibits a drop in the prediction accuracy when analysing the test dataset.</strong></p>
</div>
<section id="overfitting" class="cell markdown">
<h3><code>Overfitting</code></h3>
<p><strong>Overfitting occurs when the model fits the noise, not the underlying process. Therefore when testing your model using the test-set, your model does not perform well as it is modelling noise, not the underlying process that generated the relationship. Let's create a degree 5 polynomial model.</strong></p>
</section>
<div class="cell markdown">
<p><strong>Let's use 55 percent of the data for training and the rest for testing:</strong></p>
</div>
<div class="cell code" data-execution_count="308">
<div class="sourceCode" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="#cb207-1" aria-hidden="true" tabindex="-1"></a>x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_data, y_data, test_size<span class="op">=</span><span class="fl">0.45</span>, random_state<span class="op">=</span><span class="dv">0</span>)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We will perform a degree 5 polynomial transformation on the feature 'horse power'.</strong></p>
</div>
<div class="cell code" data-execution_count="309">
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="#cb208-1" aria-hidden="true" tabindex="-1"></a>pr <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb208-2"><a href="#cb208-2" aria-hidden="true" tabindex="-1"></a>x_train_pr <span class="op">=</span> pr.fit_transform(x_train[[<span class="st">&#39;horsepower&#39;</span>]])  </span>
<span id="cb208-3"><a href="#cb208-3" aria-hidden="true" tabindex="-1"></a>x_test_pr <span class="op">=</span> pr.fit_transform(x_test[[<span class="st">&#39;horsepower&#39;</span>]])</span>
<span id="cb208-4"><a href="#cb208-4" aria-hidden="true" tabindex="-1"></a>pr</span></code></pre></div>
<div class="output execute_result" data-execution_count="309">
<style>#sk-container-id-17 {color: black;background-color: white;}#sk-container-id-17 pre{padding: 0;}#sk-container-id-17 div.sk-toggleable {background-color: white;}#sk-container-id-17 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-17 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-17 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-17 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-17 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-17 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-17 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-17 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-17 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-17 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-17 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-17 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-17 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-17 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-17 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-17 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-17 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-17 div.sk-item {position: relative;z-index: 1;}#sk-container-id-17 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-17 div.sk-item::before, #sk-container-id-17 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-17 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-17 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-17 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-17 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-17 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-17 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-17 div.sk-label-container {text-align: center;}#sk-container-id-17 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-17 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-17" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>PolynomialFeatures(degree=5)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-31" type="checkbox" checked><label for="sk-estimator-id-31" class="sk-toggleable__label sk-toggleable__label-arrow">PolynomialFeatures</label><div class="sk-toggleable__content"><pre>PolynomialFeatures(degree=5)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>Now let's create a linear regression model <code>poly</code> and train it.</strong></p>
</div>
<div class="cell code" data-execution_count="310">
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="#cb209-1" aria-hidden="true" tabindex="-1"></a>poly <span class="op">=</span> LinearRegression()</span>
<span id="cb209-2"><a href="#cb209-2" aria-hidden="true" tabindex="-1"></a>poly.fit(x_train_pr, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="310">
<style>#sk-container-id-18 {color: black;background-color: white;}#sk-container-id-18 pre{padding: 0;}#sk-container-id-18 div.sk-toggleable {background-color: white;}#sk-container-id-18 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-18 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-18 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-18 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-18 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-18 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-18 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-18 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-18 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-18 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-18 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-18 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-18 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-18 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-18 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-18 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-18 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-18 div.sk-item {position: relative;z-index: 1;}#sk-container-id-18 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-18 div.sk-item::before, #sk-container-id-18 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-18 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-18 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-18 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-18 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-18 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-18 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-18 div.sk-label-container {text-align: center;}#sk-container-id-18 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-18 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-18" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>LinearRegression()</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-32" type="checkbox" checked><label for="sk-estimator-id-32" class="sk-toggleable__label sk-toggleable__label-arrow">LinearRegression</label><div class="sk-toggleable__content"><pre>LinearRegression()</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>We can see the output of our model using the method <code>predict.</code> then assign the values to <code>yhat</code>.</strong></p>
</div>
<div class="cell code" data-execution_count="311">
<div class="sourceCode" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="#cb210-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> poly.predict(x_test_pr)</span>
<span id="cb210-2"><a href="#cb210-2" aria-hidden="true" tabindex="-1"></a>yhat[<span class="dv">0</span>:<span class="dv">5</span>]</span></code></pre></div>
<div class="output execute_result" data-execution_count="311">
<pre><code>array([ 6727.58267154,  7306.70989608, 12213.7082022 , 18895.03221601,
       19996.83388031])</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's take the first five predicted values and compare it to the actual targets.</strong></p>
</div>
<div class="cell code" data-execution_count="312">
<div class="sourceCode" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Predicted values:&quot;</span>, yhat[<span class="dv">0</span>:<span class="dv">4</span>])</span>
<span id="cb212-2"><a href="#cb212-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;True values:&quot;</span>, y_test[<span class="dv">0</span>:<span class="dv">4</span>].values)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Predicted values: [ 6727.58267154  7306.70989608 12213.7082022  18895.03221601]
True values: [ 6295. 10698. 13860. 13499.]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We will use the function <code>PollyPlot</code> that we defined at the beginning of the section to display the training data, testing data, and the predicted function.</strong></p>
</div>
<div class="cell code" data-execution_count="313">
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="#cb214-1" aria-hidden="true" tabindex="-1"></a>PollyPlot(x_train[[<span class="st">&#39;horsepower&#39;</span>]], x_test[[<span class="st">&#39;horsepower&#39;</span>]], y_train, y_test, poly,pr)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/bd9759d22482dd31a756c37e0d0aaa7f9e98e904.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><b>Figur 4 A polynomial regression model, red dots represent training data, green dots represent test data, and the blue line represents the model prediction.</p>
<p>We see that the estimated function appears to track the data but around 200 horsepower, the function begins to diverge from the data points.</p>
<p>R^2 of the training data:</b></p>
</div>
<div class="cell code" data-execution_count="314">
<div class="sourceCode" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="#cb215-1" aria-hidden="true" tabindex="-1"></a>poly.score(x_train_pr, y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="314">
<pre><code>0.5568527853911671</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>R^2 of the test data:</strong></p>
</div>
<div class="cell code" data-execution_count="315">
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="#cb217-1" aria-hidden="true" tabindex="-1"></a>poly.score(x_test_pr, y_test)</span></code></pre></div>
<div class="output execute_result" data-execution_count="315">
<pre><code>-29.815558971873394</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We see the R^2 for the training data is 0.5567 while the R^2 on the test data was -29.87. The lower the R^2, the worse the model, a Negative R^2 is a sign of overfitting.</strong></p>
<p><strong>Let's see how the R^2 changes on the test data for different order polynomials and plot the results:</strong></p>
</div>
<div class="cell code" data-execution_count="316">
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="#cb219-1" aria-hidden="true" tabindex="-1"></a>Rsqu_test <span class="op">=</span> []</span>
<span id="cb219-2"><a href="#cb219-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-3"><a href="#cb219-3" aria-hidden="true" tabindex="-1"></a>order <span class="op">=</span> [<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>]</span>
<span id="cb219-4"><a href="#cb219-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> order:</span>
<span id="cb219-5"><a href="#cb219-5" aria-hidden="true" tabindex="-1"></a>    pr <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>n)</span>
<span id="cb219-6"><a href="#cb219-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-7"><a href="#cb219-7" aria-hidden="true" tabindex="-1"></a>    x_train_pr <span class="op">=</span> pr.fit_transform(x_train[[<span class="st">&#39;horsepower&#39;</span>]])</span>
<span id="cb219-8"><a href="#cb219-8" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-9"><a href="#cb219-9" aria-hidden="true" tabindex="-1"></a>    x_test_pr <span class="op">=</span> pr.fit_transform(x_test[[<span class="st">&#39;horsepower&#39;</span>]])    </span>
<span id="cb219-10"><a href="#cb219-10" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-11"><a href="#cb219-11" aria-hidden="true" tabindex="-1"></a>    lr.fit(x_train_pr, y_train)</span>
<span id="cb219-12"><a href="#cb219-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb219-13"><a href="#cb219-13" aria-hidden="true" tabindex="-1"></a>    Rsqu_test.append(lr.score(x_test_pr, y_test))</span>
<span id="cb219-14"><a href="#cb219-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb219-15"><a href="#cb219-15" aria-hidden="true" tabindex="-1"></a>plt.plot(order, Rsqu_test)</span>
<span id="cb219-16"><a href="#cb219-16" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;order&#39;</span>)</span>
<span id="cb219-17"><a href="#cb219-17" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;R^2&#39;</span>)</span>
<span id="cb219-18"><a href="#cb219-18" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;R^2 Using Test Data&#39;</span>)</span>
<span id="cb219-19"><a href="#cb219-19" aria-hidden="true" tabindex="-1"></a>plt.text(<span class="dv">3</span>, <span class="fl">0.75</span>, <span class="st">&#39;Maximum R^2 &#39;</span>)    </span></code></pre></div>
<div class="output execute_result" data-execution_count="316">
<pre><code>Text(3, 0.75, &#39;Maximum R^2 &#39;)</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/cf75ee6ffd9ca588f3d6533e048c2f877e4544c4.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><strong>We see the R^2 gradually increases until an order three polynomial is used. Then the R^2 dramatically decreases at four.</strong></p>
</div>
<div class="cell markdown">
<p><strong>Let's define a function f which takes two inputs, 1. order of polynomial and 2. % of test data, The functon f will be served to interact for creating interacting visuals.</strong></p>
</div>
<div class="cell code" data-execution_count="317">
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(order, test_data):</span>
<span id="cb221-2"><a href="#cb221-2" aria-hidden="true" tabindex="-1"></a>    x_train, x_test, y_train, y_test <span class="op">=</span> train_test_split(x_data, y_data, test_size<span class="op">=</span>test_data, random_state<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb221-3"><a href="#cb221-3" aria-hidden="true" tabindex="-1"></a>    pr <span class="op">=</span> PolynomialFeatures(degree<span class="op">=</span>order)</span>
<span id="cb221-4"><a href="#cb221-4" aria-hidden="true" tabindex="-1"></a>    x_train_pr <span class="op">=</span> pr.fit_transform(x_train[[<span class="st">&#39;horsepower&#39;</span>]])</span>
<span id="cb221-5"><a href="#cb221-5" aria-hidden="true" tabindex="-1"></a>    x_test_pr <span class="op">=</span> pr.fit_transform(x_test[[<span class="st">&#39;horsepower&#39;</span>]])</span>
<span id="cb221-6"><a href="#cb221-6" aria-hidden="true" tabindex="-1"></a>    poly <span class="op">=</span> LinearRegression()</span>
<span id="cb221-7"><a href="#cb221-7" aria-hidden="true" tabindex="-1"></a>    poly.fit(x_train_pr,y_train)</span>
<span id="cb221-8"><a href="#cb221-8" aria-hidden="true" tabindex="-1"></a>    PollyPlot(x_train[[<span class="st">&#39;horsepower&#39;</span>]], x_test[[<span class="st">&#39;horsepower&#39;</span>]], y_train,y_test, poly, pr)</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>The following interface allows you to experiment with different polynomial orders and different amounts of data.</strong></p>
</div>
<div class="cell code" data-execution_count="318">
<div class="sourceCode" id="cb222"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="#cb222-1" aria-hidden="true" tabindex="-1"></a>interact(f, order<span class="op">=</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">1</span>), test_data<span class="op">=</span>(<span class="fl">0.05</span>, <span class="fl">0.95</span>, <span class="fl">0.05</span>))</span></code></pre></div>
<div class="output display_data">
<div class="sourceCode" id="cb223"><pre class="sourceCode json"><code class="sourceCode json"><span id="cb223-1"><a href="#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="fu">{</span><span class="dt">&quot;version_major&quot;</span><span class="fu">:</span><span class="dv">2</span><span class="fu">,</span><span class="dt">&quot;version_minor&quot;</span><span class="fu">:</span><span class="dv">0</span><span class="fu">,</span><span class="dt">&quot;model_id&quot;</span><span class="fu">:</span><span class="st">&quot;3bbb750274d54524bafdccb6a9e37583&quot;</span><span class="fu">}</span></span></code></pre></div>
</div>
<div class="output execute_result" data-execution_count="318">
<pre><code>&lt;function __main__.f(order, test_data)&gt;</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's perform polynomial transformation with more than one feature - 'horsepower', 'curb-weight', 'engine-size', 'highway-mpg' and degree 2</strong></p>
</div>
<div class="cell code" data-execution_count="319">
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="#cb225-1" aria-hidden="true" tabindex="-1"></a>pr1 <span class="op">=</span> PolynomialFeatures(degree <span class="op">=</span> <span class="dv">2</span>)</span>
<span id="cb225-2"><a href="#cb225-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-3"><a href="#cb225-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Transform the training and testing samples for the features &#39;horsepower&#39;, &#39;curb-weight&#39;, &#39;engine-size&#39; and &#39;highway-mpg&#39;</span></span>
<span id="cb225-4"><a href="#cb225-4" aria-hidden="true" tabindex="-1"></a>x_train_pr1 <span class="op">=</span> pr1.fit_transform(x_train[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]])</span>
<span id="cb225-5"><a href="#cb225-5" aria-hidden="true" tabindex="-1"></a>x_test_pr1 <span class="op">=</span> pr1.fit_transform(x_test[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]])</span>
<span id="cb225-6"><a href="#cb225-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-7"><a href="#cb225-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;How many dimensions does the new feature have?&#39;</span>, x_train_pr1.shape)</span>
<span id="cb225-8"><a href="#cb225-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-9"><a href="#cb225-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a linear regression model &quot;poly1&quot; and train the object using the method &quot;fit&quot; using the polynomial features</span></span>
<span id="cb225-10"><a href="#cb225-10" aria-hidden="true" tabindex="-1"></a>poly1<span class="op">=</span>LinearRegression().fit(x_train_pr1,y_train)</span>
<span id="cb225-11"><a href="#cb225-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-12"><a href="#cb225-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Use the method &quot;predict&quot; to predict an output on the polynomial features, </span></span>
<span id="cb225-13"><a href="#cb225-13" aria-hidden="true" tabindex="-1"></a><span class="co"># then use the function &quot;DistributionPlot&quot; to display the distribution of the predicted output vs the test data</span></span>
<span id="cb225-14"><a href="#cb225-14" aria-hidden="true" tabindex="-1"></a>yhat_test1 <span class="op">=</span> poly1.predict(x_test_pr1)</span>
<span id="cb225-15"><a href="#cb225-15" aria-hidden="true" tabindex="-1"></a>Title<span class="op">=</span><span class="st">&#39;Distribution  Plot of  Predicted Value Using Test Data vs Data Distribution of Test Data&#39;</span></span>
<span id="cb225-16"><a href="#cb225-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb225-17"><a href="#cb225-17" aria-hidden="true" tabindex="-1"></a>DistributionPlot(y_test, yhat_test1, <span class="st">&quot;Actual Values (Test)&quot;</span>, <span class="st">&quot;Predicted Values (Test)&quot;</span>, Title)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>How many dimensions does the new feature have? (110, 15)
</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/935195a6ac0ccd00f11ae09d3d45c6c8fa3447b9.png" /></p>
</div>
</div>
<div class="cell markdown">
<p>The predicted value is higher than actual value for cars where the price $10,000 range,</p>
<p>conversely the predicted price is lower than the price cost in the $30,000  to  $40,000 range.</p>
<p>As such the model is not as accurate in these ranges</p>
</div>
<section id="part-3-ridge-regression" class="cell markdown">
<h3><code>Part 3: Ridge regression</code></h3>
<p><b>In this section, we will review Ridge Regression we will see how the parameter <code>Alfa</code> changes the model. Just a note here our test data will be used as validation data.</p>
<p>Let's perform a degree two polynomial transformation on our data.</b></p>
</section>
<div class="cell code" data-execution_count="320">
<div class="sourceCode" id="cb227"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb227-1"><a href="#cb227-1" aria-hidden="true" tabindex="-1"></a>pr<span class="op">=</span>PolynomialFeatures(degree<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb227-2"><a href="#cb227-2" aria-hidden="true" tabindex="-1"></a>x_train_pr<span class="op">=</span>pr.fit_transform(x_train[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>,<span class="st">&#39;normalized-losses&#39;</span>,<span class="st">&#39;symboling&#39;</span>]])</span>
<span id="cb227-3"><a href="#cb227-3" aria-hidden="true" tabindex="-1"></a>x_test_pr<span class="op">=</span>pr.fit_transform(x_test[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>,<span class="st">&#39;normalized-losses&#39;</span>,<span class="st">&#39;symboling&#39;</span>]])</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>Let's import Ridge from the module linear models.</strong></p>
</div>
<div class="cell code" data-execution_count="321">
<div class="sourceCode" id="cb228"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb228-1"><a href="#cb228-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.linear_model <span class="im">import</span> Ridge</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>check the predicted and test values obtained by ridge model</strong></p>
</div>
<div class="cell code" data-execution_count="322">
<div class="sourceCode" id="cb229"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb229-1"><a href="#cb229-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s create a Ridge regression object, setting the regularization parameter to 0.1</span></span>
<span id="cb229-2"><a href="#cb229-2" aria-hidden="true" tabindex="-1"></a>RigeModel<span class="op">=</span>Ridge(alpha<span class="op">=</span><span class="fl">0.1</span>)</span>
<span id="cb229-3"><a href="#cb229-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-4"><a href="#cb229-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Like regular regression, you can fit the model using the method fit.</span></span>
<span id="cb229-5"><a href="#cb229-5" aria-hidden="true" tabindex="-1"></a>RigeModel.fit(x_train_pr, y_train)</span>
<span id="cb229-6"><a href="#cb229-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-7"><a href="#cb229-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Similarly, you can obtain a prediction:</span></span>
<span id="cb229-8"><a href="#cb229-8" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> RigeModel.predict(x_test_pr)</span>
<span id="cb229-9"><a href="#cb229-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb229-10"><a href="#cb229-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Let&#39;s compare the first five predicted samples to our test set</span></span>
<span id="cb229-11"><a href="#cb229-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;predicted:&#39;</span>, yhat[<span class="dv">0</span>:<span class="dv">4</span>])</span>
<span id="cb229-12"><a href="#cb229-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;test set :&#39;</span>, y_test[<span class="dv">0</span>:<span class="dv">4</span>].values)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>predicted: [ 6569.10080596  9595.9695303  20834.19869602 19347.43557722]
test set : [ 6295. 10698. 13860. 13499.]
</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We select the value of Alpha that minimizes the test error, for example, we can use a for loop.</strong></p>
</div>
<div class="cell code" data-execution_count="323">
<div class="sourceCode" id="cb231"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb231-1"><a href="#cb231-1" aria-hidden="true" tabindex="-1"></a>Rsqu_test <span class="op">=</span> []</span>
<span id="cb231-2"><a href="#cb231-2" aria-hidden="true" tabindex="-1"></a>Rsqu_train <span class="op">=</span> []</span>
<span id="cb231-3"><a href="#cb231-3" aria-hidden="true" tabindex="-1"></a>dummy1 <span class="op">=</span> []</span>
<span id="cb231-4"><a href="#cb231-4" aria-hidden="true" tabindex="-1"></a>Alpha <span class="op">=</span> <span class="dv">10</span> <span class="op">*</span> np.array(<span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">1000</span>))</span>
<span id="cb231-5"><a href="#cb231-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> alpha <span class="kw">in</span> Alpha:</span>
<span id="cb231-6"><a href="#cb231-6" aria-hidden="true" tabindex="-1"></a>    RigeModel <span class="op">=</span> Ridge(alpha<span class="op">=</span>alpha) </span>
<span id="cb231-7"><a href="#cb231-7" aria-hidden="true" tabindex="-1"></a>    RigeModel.fit(x_train_pr, y_train)</span>
<span id="cb231-8"><a href="#cb231-8" aria-hidden="true" tabindex="-1"></a>    Rsqu_test.append(RigeModel.score(x_test_pr, y_test))</span>
<span id="cb231-9"><a href="#cb231-9" aria-hidden="true" tabindex="-1"></a>    Rsqu_train.append(RigeModel.score(x_train_pr, y_train))</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We can plot out the value of R^2 for different Alphas</strong></p>
</div>
<div class="cell code" data-execution_count="324">
<div class="sourceCode" id="cb232"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb232-1"><a href="#cb232-1" aria-hidden="true" tabindex="-1"></a>width <span class="op">=</span> <span class="dv">12</span></span>
<span id="cb232-2"><a href="#cb232-2" aria-hidden="true" tabindex="-1"></a>height <span class="op">=</span> <span class="dv">10</span></span>
<span id="cb232-3"><a href="#cb232-3" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(width, height))</span>
<span id="cb232-4"><a href="#cb232-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb232-5"><a href="#cb232-5" aria-hidden="true" tabindex="-1"></a>plt.plot(Alpha,Rsqu_test, label<span class="op">=</span><span class="st">&#39;validation data  &#39;</span>)</span>
<span id="cb232-6"><a href="#cb232-6" aria-hidden="true" tabindex="-1"></a>plt.plot(Alpha,Rsqu_train, <span class="st">&#39;r&#39;</span>, label<span class="op">=</span><span class="st">&#39;training Data &#39;</span>)</span>
<span id="cb232-7"><a href="#cb232-7" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;alpha&#39;</span>)</span>
<span id="cb232-8"><a href="#cb232-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;R^2&#39;</span>)</span>
<span id="cb232-9"><a href="#cb232-9" aria-hidden="true" tabindex="-1"></a>plt.legend()</span></code></pre></div>
<div class="output execute_result" data-execution_count="324">
<pre><code>&lt;matplotlib.legend.Legend at 0x1b6e3041100&gt;</code></pre>
</div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/8531b66e2dc522bc8f932a7cdbc4fc64795bc318.png" /></p>
</div>
</div>
<div class="cell markdown">
<p><b> Figure 6:The blue line represents the R^2 of the validation data, and the red line represents the R^2 of the training data. The x-axis represents the different values of Alpha.</p>
<p>Here the model is built and tested on the same data. So the training and test data are the same.</p>
<p>The red line in figure 6 represents the R^2 of the training data. As Alpha increases the R^2 decreases. Therefore as Alpha increases the model performs worse on the training data.</p>
<p>The blue line represents the R^2 on the validation data. As the value for Alpha increases the R^2 increases and converges at a point </b></p>
</div>
<section id="part-4-grid-search" class="cell markdown">
<h1><code>Part 4: Grid Search</code></h1>
<p><b>The term Alfa is a hyperparameter, sklearn has the class GridSearchCV to make the process of finding the best hyperparameter simpler.</p>
<p>Let's import GridSearchCV from the module model_selection.</b></p>
</section>
<div class="cell code" data-execution_count="325">
<div class="sourceCode" id="cb234"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb234-1"><a href="#cb234-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> GridSearchCV</span></code></pre></div>
</div>
<div class="cell markdown">
<p><strong>We create a dictionary of parameter values:</strong></p>
</div>
<div class="cell code" data-execution_count="326">
<div class="sourceCode" id="cb235"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb235-1"><a href="#cb235-1" aria-hidden="true" tabindex="-1"></a>parameters1<span class="op">=</span> [{<span class="st">&#39;alpha&#39;</span>: [<span class="fl">0.001</span>,<span class="fl">0.1</span>,<span class="dv">1</span>, <span class="dv">10</span>, <span class="dv">100</span>, <span class="dv">1000</span>, <span class="dv">10000</span>, <span class="dv">100000</span>, <span class="dv">100000</span>]}]</span>
<span id="cb235-2"><a href="#cb235-2" aria-hidden="true" tabindex="-1"></a>parameters1</span></code></pre></div>
<div class="output execute_result" data-execution_count="326">
<pre><code>[{&#39;alpha&#39;: [0.001, 0.1, 1, 10, 100, 1000, 10000, 100000, 100000]}]</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's create ridge grid search object and train the model ove ('horsepower', 'curb-weight', 'engine-size', 'highway-mpg') with folds 4</strong></p>
</div>
<div class="cell code" data-execution_count="327">
<div class="sourceCode" id="cb237"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb237-1"><a href="#cb237-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a ridge regions object:</span></span>
<span id="cb237-2"><a href="#cb237-2" aria-hidden="true" tabindex="-1"></a>RR<span class="op">=</span>Ridge()</span>
<span id="cb237-3"><a href="#cb237-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-4"><a href="#cb237-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a ridge grid search object</span></span>
<span id="cb237-5"><a href="#cb237-5" aria-hidden="true" tabindex="-1"></a>Grid1 <span class="op">=</span> GridSearchCV(RR, parameters1,cv<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb237-6"><a href="#cb237-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb237-7"><a href="#cb237-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit the model</span></span>
<span id="cb237-8"><a href="#cb237-8" aria-hidden="true" tabindex="-1"></a>Grid1.fit(x_data[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]], y_data)</span></code></pre></div>
<div class="output execute_result" data-execution_count="327">
<style>#sk-container-id-19 {color: black;background-color: white;}#sk-container-id-19 pre{padding: 0;}#sk-container-id-19 div.sk-toggleable {background-color: white;}#sk-container-id-19 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-19 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-19 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-19 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-19 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-19 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-19 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-19 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-19 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-19 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-19 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-19 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-19 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-19 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-19 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-19 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-19 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-19 div.sk-item {position: relative;z-index: 1;}#sk-container-id-19 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-19 div.sk-item::before, #sk-container-id-19 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-19 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-19 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-19 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-19 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-19 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-19 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-19 div.sk-label-container {text-align: center;}#sk-container-id-19 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-19 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-19" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>GridSearchCV(cv=4, estimator=Ridge(),
             param_grid=[{&#x27;alpha&#x27;: [0.001, 0.1, 1, 10, 100, 1000, 10000, 100000,
                                    100000]}])</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item sk-dashed-wrapped"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-33" type="checkbox" ><label for="sk-estimator-id-33" class="sk-toggleable__label sk-toggleable__label-arrow">GridSearchCV</label><div class="sk-toggleable__content"><pre>GridSearchCV(cv=4, estimator=Ridge(),
             param_grid=[{&#x27;alpha&#x27;: [0.001, 0.1, 1, 10, 100, 1000, 10000, 100000,
                                    100000]}])</pre></div></div></div><div class="sk-parallel"><div class="sk-parallel-item"><div class="sk-item"><div class="sk-label-container"><div class="sk-label sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-34" type="checkbox" ><label for="sk-estimator-id-34" class="sk-toggleable__label sk-toggleable__label-arrow">estimator: Ridge</label><div class="sk-toggleable__content"><pre>Ridge()</pre></div></div></div><div class="sk-serial"><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-35" type="checkbox" ><label for="sk-estimator-id-35" class="sk-toggleable__label sk-toggleable__label-arrow">Ridge</label><div class="sk-toggleable__content"><pre>Ridge()</pre></div></div></div></div></div></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>The object finds the best parameter values on the validation data. We can obtain the estimator with the best parameters and assign it to the variable BestRR as follows:</strong></p>
</div>
<div class="cell code" data-execution_count="328">
<div class="sourceCode" id="cb238"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb238-1"><a href="#cb238-1" aria-hidden="true" tabindex="-1"></a>BestRR<span class="op">=</span>Grid1.best_estimator_</span>
<span id="cb238-2"><a href="#cb238-2" aria-hidden="true" tabindex="-1"></a>BestRR</span></code></pre></div>
<div class="output execute_result" data-execution_count="328">
<style>#sk-container-id-20 {color: black;background-color: white;}#sk-container-id-20 pre{padding: 0;}#sk-container-id-20 div.sk-toggleable {background-color: white;}#sk-container-id-20 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-20 label.sk-toggleable__label-arrow:before {content: "▸";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-20 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-20 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-20 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-20 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-20 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-20 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: "▾";}#sk-container-id-20 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-20 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-20 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-20 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-20 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-20 div.sk-parallel-item::after {content: "";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-20 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-20 div.sk-serial::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-20 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-20 div.sk-item {position: relative;z-index: 1;}#sk-container-id-20 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-20 div.sk-item::before, #sk-container-id-20 div.sk-parallel-item::before {content: "";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-20 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-20 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-20 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-20 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-20 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-20 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-20 div.sk-label-container {text-align: center;}#sk-container-id-20 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-20 div.sk-text-repr-fallback {display: none;}</style><div id="sk-container-id-20" class="sk-top-container"><div class="sk-text-repr-fallback"><pre>Ridge(alpha=10000)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class="sk-container" hidden><div class="sk-item"><div class="sk-estimator sk-toggleable"><input class="sk-toggleable__control sk-hidden--visually" id="sk-estimator-id-36" type="checkbox" checked><label for="sk-estimator-id-36" class="sk-toggleable__label sk-toggleable__label-arrow">Ridge</label><div class="sk-toggleable__content"><pre>Ridge(alpha=10000)</pre></div></div></div></div></div>
</div>
</div>
<div class="cell markdown">
<p><strong>We now test our model on the test data</strong></p>
</div>
<div class="cell code" data-execution_count="329">
<div class="sourceCode" id="cb239"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb239-1"><a href="#cb239-1" aria-hidden="true" tabindex="-1"></a>BestRR.score(x_test[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]], y_test)</span></code></pre></div>
<div class="output execute_result" data-execution_count="329">
<pre><code>0.841178138779323</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>We now test our model on the training data</strong></p>
</div>
<div class="cell code" data-execution_count="330">
<div class="sourceCode" id="cb241"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb241-1"><a href="#cb241-1" aria-hidden="true" tabindex="-1"></a>BestRR.score(x_train[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]], y_train)</span></code></pre></div>
<div class="output execute_result" data-execution_count="330">
<pre><code>0.7678682438637905</code></pre>
</div>
</div>
<div class="cell markdown">
<p><strong>Let's visualize our model wihh alpha = 10000</strong></p>
</div>
<div class="cell code" data-execution_count="331">
<div class="sourceCode" id="cb243"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb243-1"><a href="#cb243-1" aria-hidden="true" tabindex="-1"></a>yhat <span class="op">=</span> BestRR.predict(x_test[[<span class="st">&#39;horsepower&#39;</span>, <span class="st">&#39;curb-weight&#39;</span>, <span class="st">&#39;engine-size&#39;</span>, <span class="st">&#39;highway-mpg&#39;</span>]])</span>
<span id="cb243-2"><a href="#cb243-2" aria-hidden="true" tabindex="-1"></a>Title<span class="op">=</span><span class="st">&#39;Distribution  Plot of Test Data vs Predicted Test Data with alpha 10000&#39;</span></span>
<span id="cb243-3"><a href="#cb243-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb243-4"><a href="#cb243-4" aria-hidden="true" tabindex="-1"></a>DistributionPlot(y_test, yhat, <span class="st">&quot;Actual Values (Test)&quot;</span>, <span class="st">&quot;Predicted Values (Test)&quot;</span>, Title)</span></code></pre></div>
<div class="output display_data">
<p><img src="vertopal_5edf15ec89154aada2eac82943ce47ae/5d711a0927cca5090ce2cc37352315736a0bb8c4.png" /></p>
</div>
</div>
<section id="conclusion" class="cell markdown">
<h2><code>Conclusion</code></h2>
<p><b><code>Our model with the inputs - ('horsepower', 'curb-weight', 'engine-size', 'highway-mpg') can predict the Price of the second hand car with the efficiency of 84%</code></b></p>
</section>
</body>
</html>
